## TIL (Today I Learned)

### 8ì›” 28ì¼ (ì›”)    

- ### [í•™ìŠµë‚´ìš©] UIApplicationDelegateAdaptor
    ### UIApplicationDelegateAdaptor?

    ìš°ì„  UIApplicationDelegateaAdaptorëŠ” SwiftUIì—ì„œ UIKit app delegateë¥¼ ìƒì„±í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” í”„ë¡œí¼í‹° ë˜í¼ì…ë‹ˆë‹¤.

    ```swift
    @MainActor @propertyWrapper
    struct UIApplicationDelegateAdaptor<DelegateType> where DelegateType : NSObject, DelegateType : UIApplicationDelegate
    ```

    ì„ ì–¸ì€ ìœ„ì™€ ê°™ì´ ë˜ì–´ ìˆëŠ” í”„ë¡œí¼í‹° ë˜í¼ì´ì£ !

    SwiftUIì˜ ë¼ì´í”„ ì‚¬ì´í´ì„ ì‚¬ìš©í•˜ëŠ” ì•±ì—ì„œ ì•±ë”œë¦¬ê²Œì´íŠ¸ ì½œë°±ì„ ì²˜ë¦¬í•˜ë ¤ë©´ UIApplicationDelegate í”„ë¡œí† ì½œì„ ì¤€ìˆ˜í•˜ì—¬ì•¼í•˜ê³ , ê°ì í•„ìš”í•œ ë”œë¦¬ê²Œì´íŠ¸ ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.

    ì˜ˆì‹œë¡œ ì›ê²© ë…¸í‹°í”¼ì¼€ì´ì…˜ì„ ë“±ë¡í•˜ëŠ” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼ëœë‹¤ê³  ê°€ì •í•´ë³¼ê»˜ìš”!

    ê·¸ëŸ¼ ê°€ì¥ ë¨¼ì € ì•„ë˜ì™€ ê°™ì´ UIApplicationDelegateë¥¼ ì±„íƒí•˜ëŠ” ì•±ë”œë¦¬ê²Œì´íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê²Œ ë©ë‹ˆë‹¤.

    ```swift
    class MyAppDelegate: NSObject, UIApplicationDelegate, ObservableObject {
      func application(
        _ application: UIApplication,
        didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data
      ) {
          // Record the device token.
      }
    }
    ```

    ê·¸ í›„ ì´ì œ SwiftUI App ì½”ë“œì—ì„œ UIApplicationDelegateAdaptor í”„ë¡œí¼í‹° ë˜í¼ë¥¼ ì‚¬ìš©í•´ SwiftUIì—ê²Œ ë”œë¦¬ê²Œì´íŠ¸ íƒ€ì…ì— ëŒ€í•´ ì„ ì–¸í•´ì¤ë‹ˆë‹¤.

    ```swift
    @main
    struct MyApp: App {
      @UIApplicationDelegateAdaptor private var appDelegate: MyAppDelegate

      var body: some Scene { ... }
    }
    ```

    í˜¹ì€ ì„ ì–¸ì„ ì´ë ‡ê²Œë„ ì“¸ ìˆ˜ ìˆì–´ìš”!

    ```swift
    @UIApplicationDelegateAdaptor(MyAppDelegate.self) var appDelegate
    ```

    SwiftUIëŠ” ë”œë¦¬ê²Œì´íŠ¸ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ê³  ìƒëª…ì£¼ê¸° ì´ë²¤íŠ¸ê°€ ë°œìƒí• ë•Œë§ˆë‹¤ ì‘ë‹µí•´ ë”œë¦¬ê²Œì´íŠ¸ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
    ë”œë¦¬ê²Œì´íŠ¸ ì–´ëŒ‘í„°ëŠ” ì•± ì„ ì–¸ë¶€ì—ì„œë§Œ ì •ì˜í•˜ê³ , ì•±ì—ì„œ ê¼­ í•œë²ˆë§Œ ì„ ì–¸í•´ì•¼ í•©ë‹ˆë‹¤!

    ë§Œì•½ ì—¬ëŸ¬ë²ˆ ì„ ì–¸ì„ í•˜ê²Œ ëœë‹¤ë©´ SwiftUIëŠ” ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ì£ .

    ì•±ì˜ ë”œë¦¬ê²Œì´íŠ¸ê°€ ìœ„ ì½”ë“œ ì˜ˆì‹œì²˜ëŸ¼ ObservableObject í”„ë¡œí† ì½œì„ ì¤€ìˆ˜í•˜ëŠ” ê²½ìš°ì—, SwiftUIëŠ” ìƒì„±í•œ ë”œë¦¬ê²Œì´íŠ¸ë¥¼ Environmentì— ì €ì¥í•©ë‹ˆë‹¤.
    ì¦‰, ì•± ë‚´ ì–´ë–¤ Scene í˜¹ì€ Viewì—ì„œë„ EnvironmentObject í”„ë¡œí¼í‹° ë˜í¼ë¥¼ í†µí•´ í•´ë‹¹ ë”œë¦¬ê²Œì´íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ```swift
    @EnvironmentObject private var appDelegate: MyAppDelegate
    ```

    ì´ë ‡ê²Œ í•˜ë©´, ë”œë¦¬ê²Œì´íŠ¸ì—ì„œ ì„ ì–¸í•œ Published í”„ë¡œí¼í‹°ì— ëŒ€í•œ ë°”ì¸ë”©ì„ ì–»ê¸° ìœ„í•´ $(ë‹¬ëŸ¬) ê¸°í˜¸ ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    í•´ë‹¹ ë¶€ë¶„ì—ì„œ ê¶ê¸ˆí•˜ì‹œë‹¤ë©´ projectedValueë¥¼ í•™ìŠµí•´ë³´ë©´ ë©ë‹ˆë‹¤ ğŸ˜ƒ

    ì¤‘ìš”í•œê±´ ê°€ê¸‰ì ì´ë©´ ê°€ëŠ¥í•œ ê²½ìš° ì•± ë”œë¦¬ê²Œì´íŠ¸ ì—†ì´ ì•±ì˜ ìƒëª…ì£¼ê¸° ì´ë²¤íŠ¸ë¥¼ ê´€ë¦¬í•˜ëŠ”ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

    ì˜ˆë¥¼ë“¤ì–´, application(_:didFinishLaunchingWithOptions:)ì™€ ê°™ì€ ë”œë¦¬ê²Œì´íŠ¸ ì½œë°±ì— ì˜ì¡´í•˜ê¸° ë³´ë‹¤ëŠ” ScenePhaseì˜ ë³€í™”ë¥¼ ì²˜ë¦¬í•˜ëŠ”ê²ƒì„ SwiftUIì—ì„œëŠ” ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.

    ### Scene Delegate

    ì¼ë¶€ iOS ì•±ì€ ì•± ë‹¨ì¶•í‚¤ì™€ ê°™ì€ Scene ê¸°ë°˜ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ UIWindowSceneDelegateë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

    ```swift
    class MySceneDelegate: NSObject, UIWindowSceneDelegate, ObservableObject {
      func windowScene(
        _ windowScene: UIWindowScene,
        performActionFor shortcutItem: UIApplicationShortcutItem
      ) async -> Bool {
       // Do something with the shortcut...
       return true
      }
    }
    ```

    ì•± ë”œë¦¬ê²Œì´íŠ¸ ë‚´ë¶€ì˜ application(_:configurationForConnecting:options:) ë©”ì„œë“œì—ì„œ scene delegateì˜ íƒ€ì…ì„ ë°˜í™˜í•¨ìœ¼ë¡œ ì´ëŸ¬í•œ ì¢…ë¥˜ì˜ ë”œë¦¬ê²Œì´íŠ¸ë¥¼ SwiftUI ì•±ì— ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ```swift
    extension MyAppDelegate {
      func application(
        _ application: UIApplication,
        configurationForConnecting connectingSceneSession: UISceneSession,
        options: UIScene.ConnectionOptions
      ) -> UISceneConfiguration {
        let configuration = UISceneConfiguration(
          name: nil,
          sessionRole: connectingSceneSession.role)
        if connectingSceneSession.role == .windowApplication {
          configuration.delegateClass = MySceneDelegate.self
        }
        return configuration
      }
    }
    ```

    UISceneConfiguration ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•  ë•Œ, Scene í´ë˜ìŠ¤ë‚˜ ìŠ¤í† ë¦¬ë³´ë“œ ëŒ€ì‹  ë”œë¦¬ê²Œì´íŠ¸ í´ë˜ìŠ¤ë§Œ ëª…ì‹œí•˜ë©´ ë©ë‹ˆë‹¤.
    SwiftUIëŠ” ë”œë¦¬ê²Œì´íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë©°, ê´€ë ¨ëœ ë”œë¦¬ê²Œì´íŠ¸ ì½œë°±ì„ ì „ì†¡í•˜ì£ .

    ì•± ë”œë¦¬ê²Œì´íŠ¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, Scene delegateë¥¼ ObservableObjectë¡œ ë§Œë“¤ ê²½ìš°, SwiftUIëŠ” ìë™ìœ¼ë¡œ ì´ë¥¼Envrionmentì— ì €ì¥í•©ë‹ˆë‹¤.
    ê·¸ë ‡ê²Œ ë˜ë©´ EnvironmentObject í”„ë¡œí¼í‹° ë˜í¼ë¥¼ í†µí•´ í•´ë‹¹ ë”œë¦¬ê²Œì´íŠ¸ì— ì ‘ê·¼í•˜ê³  Published ì†ì„±ë“¤ì— ëŒ€í•œ ë°”ì¸ë”©ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ### ë§ˆë¬´ë¦¬

    ë¬¼ë¡ , App/SceneDelegateë¥¼ UIKitì²˜ëŸ¼ ë§Œë“¤ê³  êµ¬ì„±í•˜ê³  ê±°ê¸°ì„œ ContentViewë¥¼ ì˜¬ë ¤ì„œ App ì½”ë“œ ì—†ì´ë„ ì‚¬ìš©í•  ìˆ˜ ìˆì£ .
    SceneDelegateì—ì„œ UIWindowScene íƒ€ì…ì˜ sceneì„ ë§Œë“¤ê³  windowë¡œ í•´ë‹¹ ë·°ë¥¼ ë„ì›Œì£¼ëŠ” ì§„ì…ì ì„ ì‚¬ìš©í•˜ëŠ” ê·¸ëŸ° ì‚¬ìš©ë²•ì²˜ëŸ¼ ë§ì´ì£ !
    ê·¸ê²ƒë„ í•˜ë‚˜ì˜ ë°©ë²•ì´ë©°, App êµ¬ì¡°ì²´ë¥¼ í†µí•´ ì¡°ê¸ˆ ë” SwiftUIìŠ¤ëŸ½ê²Œ ê°€ì ¸ê°€ëŠ”ê²ƒì—ì„œ ì˜¤ëŠ˜ í•™ìŠµí•´ë³¸ UIApplicationDelegateAdaptorê°€ ë„ì›€ì´ ë ê²ƒ ê°™ìŠµë‹ˆë‹¤ ğŸš€

    ### ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤

    https://developer.apple.com/documentation/swiftui/uiapplicationdelegateadaptor    
    
    ### ë³¸ë¬¸ ë¸”ë¡œê·¸   
    https://green1229.tistory.com/401
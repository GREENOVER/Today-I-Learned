## TIL (Today I Learned)

### 11ì›” 7ì¼ (ì›”)   

- ### [í•™ìŠµë‚´ìš©] 
  ### SwiftUIì—ì„œ TapGestureë¥¼ í†µí•´ í˜„ì¬ Position êµ¬í•˜ê¸°
    #### iOS 16 ì´í›„ onTapGesture

    iOS 16 ì´ì „ì—ëŠ” onTapGesture ë©”ì„œë“œë¥¼ í†µí•´ íƒ­ ë˜ì—ˆì„ë•Œ í˜„ì¬ íƒ­ ëœ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì—†ì—ˆì–´ìš”.
    ê·¸ë˜ì„œ ì˜¤ëŠ˜ í•  ì£¼ì œì´ê¸°ë„ í•˜ì§€ë§Œ SwiftUIì˜ ì œìŠ¤ì³ë“¤ì„ ì˜ ì¡°í•©í•˜ì—¬ ì»¤ìŠ¤í…€í•˜ê²Œ ë§Œë“¤ì–´ì£¼ë©´ì„œ ì•„ì£¼ ë¶ˆí¸í•˜ê²Œ ì‚¬ìš©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.
    ë”êµ°ë‹¤ê°€ ì—¬ëŸ¬ ì œìŠ¤ì³ê°€ ë™ì‹œ ë‹¤ë°œì ì´ë¼ë©´ ì˜¤ë¥˜ê°€ ë§ì„ë•Œë„ ë§ì•˜êµ¬ìš”.
    ê·¸ë ‡ê¸°ì— ì´ë²ˆ ì—…ë°ì´íŠ¸ë¥¼ í†µí•´ ì´ ë¶ˆí¸í•¨ì„ ì• í”Œì—ì„œ ì–´ëŠì •ë„ í•´ì†Œí•´ì¤¬ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.
    ì„ ì–¸ì€ ì´ë ‡ìŠµë‹ˆë‹¤.
    ```swift
    func onTapGesture(
        count: Int = 1,
        coordinateSpace: CoordinateSpace = .local,
        perform action: @escaping (CGPoint) -> Void
    ) -> some View
  ```
    coordinateSpaceë¼ëŠ”ê²ƒì´ ìƒê²¼ì£ ?
    ì´ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ìœ„ì¹˜ë¥¼ íŒë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    CoordinateSpace íƒ€ì…ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì •ì˜ëœ local, global, named()ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.

    ì—¬ê¸°ì„œ localì€ ìì‹  ì¦‰ ì…€í”„ë·°ì™€ ì—°ê´€í•˜ì—¬ í˜„ì¬ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ë©° globalì€ ì „ì²´ ë””ë°”ì´ìŠ¤ì—ì„œì˜ ìœ„ì¹˜ë¥¼ íŒë‹¨í•´ì¤ë‹ˆë‹¤.
    namedëŠ” named("scroll")ê³¼ ê°™ì´ ê°œë°œ ì‹œ ì§€ì •í•´ì¤€ Stringìœ¼ë¡œ ì§€ì •ëœ ë·°ë¡œë¶€í„°ì˜ ìœ„ì¹˜ë¥¼ íŒë‹¨í•©ë‹ˆë‹¤.
    ì´ê²ƒë§Œ ì˜ ì•Œë©´ë©ë‹ˆë‹¤ğŸ¥³
    ê·¸ ì™¸ countëŠ” ëª‡ë²ˆ íƒ­ ë˜ì—ˆì„ë•Œ íƒ­ ì œìŠ¤ì³ë¥¼ ìˆ˜í–‰í• ê²ƒì¸ì§€ì´ê³  íƒˆì¶œ í´ë¡œì €ë¡œ íƒ­ ëœ í›„ì˜ ë™ì‘í•  ì•¡ì…˜ ë¡œì§ì„ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.
    í•­ìƒ ëŠ˜ ë¨¹ë˜ ë°©ë²•ì¸ë° coordinateSpaceê°€ ì¶”ê°€ëœê²ƒì´ì£ !

    ê·¸ëŸ¼ ì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?
    ```swift
    struct TapGestureExample: View {
      @State private var location: CGPoint = .zero

      var body: some View {
        Circle()
          .fill(self.location.y > 50 ? Color.blue : Color.red)
          .frame(width: 100, height: 100, alignment: .center)
          .onTapGesture(count:1, coordinateSpace: .global) { location in
            self.location = location
        }
      }
    }
  ```
    ì´ë ‡ê²Œ ì›í•˜ëŠ” ë·°ì˜ onTapGestureë¥¼ ë¶™ì—¬ locationì„ íŒë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ì¦‰ í•´ë‹¹ ì½”ë“œì—ì„œ ì›ì„ í•œë²ˆ íƒ­í•˜ë©´ ì „ì²´ ë””ë°”ì´ìŠ¤ì˜ ì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í˜„ì¬ íƒ­ ëœ ìœ„ì¹˜ê°€ location ê°’ìœ¼ë¡œ ì €ì¥ë˜ê²Œ ë©ë‹ˆë‹¤.

    ì•„ì£¼ ì•„ì£¼ ì‰½ì£ ? iOS 16 ì´ìƒ ë¯¸ë‹ˆë©ˆ íƒ€ê²Ÿìœ¼ë¡œ ì‚¬ìš©í•˜ì‹ ë‹¤ë©´ ì—¬ê¸°ê¹Œì§€ë§Œ ë³´ì…”ë„ ë©ë‹ˆë‹¤.

    iOS 16 ì´í•˜ë„ ì´ëŸ° ê¸°ëŠ¥ì„ ì§€ì›í•´ì•¼í•œë‹¤ë©´....
    ì´ì œ ë°”ë¡œ ë³´ì‹œì£ !

    iOS 16 ì´í•˜ì—ì„œëŠ” ìœ„ì™€ ê°™ì€ ê¸°ë³¸ì ìœ¼ë¡œ êµ¬í˜„ëœ ê¸°ëŠ¥ì´ ì „í˜€ ì—†ìŠµë‹ˆë‹¤.
    ê·¸ë ‡ê¸°ì— SwiftUI ì„¸ìƒì—ì„œëŠ” ê¸°ì¡´ êµ¬í˜„ëœ ì œìŠ¤ì³ë“¤ì˜ ì¡°í•©ì„ í†µí•´ ì´ëŸ° ê¸°ëŠ¥ë“¤ì„ ì»¤ìŠ¤í…€í•˜ê²Œ ë§Œë“¤ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
    ì ê·¸ëŸ¼ ë§Œë“¤ì–´ë³´ìêµ¬ìš”!

    #### iOS 16 ì´ì „ SwiftUI ì„¸ìƒì—ì„œ Tap ìœ„ì¹˜ êµ¬í•˜ëŠ” ì»¤ìŠ¤í…€ ì œìŠ¤ì³ ë§Œë“¤ê¸°

    ìš°ì„  ë‘ê°€ì§€ë¥¼ í™œìš©í•´ì•¼ í•©ë‹ˆë‹¤.
    TapGestureì™€ DragGesture
    TapGestureì—ì„œëŠ” í˜„ì¬ íƒ­ ëœ ìœ„ì¹˜ë¥¼ êµ¬í• ìˆ˜ê°€ ì „í˜€ ì—†ì§€ë§Œ DragGestureì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë“œë˜ê¹…ì„ ìœ„í•´ ë“œë˜ê·¸ê°€ ì‹œì‘ëœ í˜„ì¬ ìœ„ì¹˜ì™€ ì¤‘ê°„ ê·¸ë¦¬ê³  ëë‚˜ëŠ” ìœ„ì¹˜ë“¤ì„ ëª¨ë‘ êµ¬í•  ìˆ˜ ìˆì–´ìš”.
    ê·¸ë ‡ê¸°ì— ìš°ë¦¬ëŠ” ì´ ë‘ê°€ì§€ë¥¼ ì˜ ì„ì–´ì„œ í•˜ë‚˜ì˜ TapGestureë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    (ë‹¹ì—°í•˜ì§€ë§Œ ì•¼ë§¤ê°™ì€ ëŠë‚Œì´ì£ !)

    ê·¸ëŸ¼ ì½”ë“œë¡œ ë¨¼ì € ë³´ì‹œì£ ğŸ™‹ğŸ»
    ì•„ë˜ ì˜¤ëŠ˜ ì•Œì•„ë³¼ ì½”ë“œë“¤ì€ ì°¸ê³  ìë£Œì— ìˆëŠ” ìŠ¤íƒì˜¤ë²„í”Œë¡œì˜ í•´ê²°ë°©ì•ˆì¤‘ í•˜ë‚˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤!
    ```swift
    import SwiftUI

    public struct CustomTapGesture: Gesture {
      public typealias Value = SimultaneousGesture<TapGesture, DragGesture>.Value

      let count: Int
      let coordinateSpace: CoordinateSpace

      init(
        count: Int = 1,
        coordinateSpace: CoordinateSpace = .global
      ) {
        self.count = count
        self.coordinateSpace = coordinateSpace
      }

      public var body: SimultaneousGesture<TapGesture, DragGesture> {
        SimultaneousGesture(
          TapGesture(count: count),
          DragGesture(minimumDistance: 0, coordinateSpace: coordinateSpace)
        )
      }

      public func onEnded(perform action: @escaping (CGPoint) -> Void) -> _EndedGesture<CustomTapGesture> {
        self.onEnded { (value: Value) -> Void in
          guard value.first != nil else { return }
          guard let location = value.second?.startLocation else { return }
          guard let endLocation = value.second?.location else { return }
          guard ((location.x-1)...(location.x+1))
            .contains(endLocation.x), ((location.y-1)...(location.y+1))
            .contains(endLocation.y) else {
            return
          }
          action(location)
        }
      }
    }
    ```
    ë³´ì‹œë©´ SimultaneousGestureë¡œ íƒ­ê³¼ ë“œë˜ê·¸ ì œìŠ¤ì³ë¥¼ ë°›ì•„ìš”.
    ì¦‰ ë‘ ì œìŠ¤ì³ë¥¼ ë™ì‹œì— í•©ì³ì£¼ê² ë‹¤ëŠ” ì†Œë¦¬ì…ë‹ˆë‹¤.
    íƒ­ì´ ë˜ì—ˆì„ë•Œ ë“œë˜ê·¸ë¥¼ íŒë‹¨í•´ìš”.
    ë“œë˜ê·¸ì˜ ìµœì†Œ ê±°ë¦¬ê°€ 0 ì¦‰, í•­ìƒ íŒë‹¨í•˜ê²Œ ëœë‹¤ëŠ” ì†Œë¦¬ì…ë‹ˆë‹¤.
    ê·¸ë¦¬ê³  íƒ­ì´ ëë‚¬ì„ë•Œ ë“œë˜ê·¸ë„ ëë‚˜ê²Œ ë˜ë‹ˆ locationì„ onEndedì—ì„œ êµ¬í•  ìˆ˜ ìˆì–´ìš”.
    êµ¬í•˜ëŠ”ê²ƒì€ íƒ­ë ë•Œ ë“œë˜ê·¸ë„ ë™ì‹œ ì§„í–‰ë˜ë‹ˆ startLocationë§Œ ì‚¬ì‹¤ ì•Œë©´ë˜ì£ .
    ê·¸ëŸ°ë° íƒ­ì´ ëë‚ ë•Œ ë“œë˜ê·¸ë„ ëë‚˜ê³  ì´ê²Œ ë“œë˜ê·¸ì¸ì§€ íƒ­ì¸ì§€ ì˜¤ì°¨ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ +-1ì˜ ì˜¤ì°¨ ë²”ìœ„ë¥¼ êµ¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤.
    ì´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ íƒ­ ì œìŠ¤ì³ë¼ê³  íŒë‹¨í•  ìˆ˜ ì—†ìœ¼ë‹ˆ returní•´ì£¼ë©´ ë˜ì£ .

    ê²°êµ­ ë§Œë“¤ì–´ì§„ ì´ ì œìŠ¤ì³ë¥¼ ì•„ë˜ì™€ ê°™ì´ Viewì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ViewModifierë¡œ ë§Œë“¤ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.
    ```swift
    import SwiftUI

    extension View {
      public func onCustomTapGesture(
        count: Int,
        coordinateSpace: CoordinateSpace = .global,
        perform action: @escaping (CGPoint) -> Void
      ) -> some View {
        simultaneousGesture(CustomTapGesture(count: count, coordinateSpace: coordinateSpace)
          .onEnded(perform: action)
        )
      }

      public func onCustomTapGesture(
        count: Int,
        perform action: @escaping (CGPoint) -> Void
      ) -> some View {
        onCustomTapGesture(count: count, coordinateSpace: .global, perform: action)
      }

      public func onCustomTapGesture(
        perform action: @escaping (CGPoint) -> Void
      ) -> some View {
        onCustomTapGesture(count: 1, coordinateSpace: .global, perform: action)
      }
    }
    ```
    Viewë¥¼ extensioní•˜ì—¬ ì»¤ìŠ¤í…€ íƒ­ ì œìŠ¤ì³ View Modifierë¥¼ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆì–´ìš”.
    ì €ì˜ ê²½ìš°ëŠ” íƒ­ì€ í•œë²ˆë§Œ ê·¸ë¦¬ê³  ìœ„ì¹˜ íŒë‹¨ì€ ë””ë°”ì´ìŠ¤ ì „ì²´ ì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‚¼ì•˜ìŠµë‹ˆë‹¤.
    ì´ì œ ì›í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ë„£ì–´ í¸í•˜ê²Œ ì…ë§›ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
    ì´í›„ ì‚¬ìš©ë¶€ì—ì„œ actionì— ì›í•˜ëŠ” ë¡œì§ë§Œ ì˜ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤!

    ê·¸ëŸ¼ í•œë²ˆ ì‚¬ìš©í•´ë³¼ê»˜ìš”!
    ```swift
    import SwiftUI

    struct ContentView: View {
      @State private var location: CGPoint = .zero

      var body: some View {
        VStack(spacing: 20) {
          Image(systemName: "globe")
            .imageScale(.large)
            .foregroundColor(.accentColor)
            .onCustomTapGesture { location in
              self.location = location
            }

          Text("Get position of Tap Gesture")
            .onCustomTapGesture { location in
              self.location = location
            }

          Circle()
            .fill(self.location.y > 350 ? Color.blue : Color.red)
            .frame(width: 100, height: 100, alignment: .center)
            .onCustomTapGesture { location in
              self.location = location
            }

          Text("current position is \(location.x) \(location.y)")
        }
        .padding()
      }
    }
    ```
    ìš”ë ‡ê²Œ ì•„ì£¼ ì‰¬ìš´ ì˜ˆì œ ì½”ë“œë¥¼ ì§œë´¤ì–´ìš”.
    ì´ëŸ¬ë©´ ê° ë·°ê°€ íƒ­ë˜ë©´ ì œì¼ í•˜ë‹¨ í˜„ì¬ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ëŠ” í…ìŠ¤íŠ¸ê°€ ë°”ë€”ê±°ì—ìš”.
    ë˜í•œ Circleì˜ ìƒ‰ìƒë„ íƒ­ ëœ í¬ì§€ì…˜ì— ë”°ë¼ ë°”ë€ë‹ˆë‹¤.

    #### ë§ˆë¬´ë¦¬

    SwiftUI ì„¸ìƒì— ì˜¤ì‹ ê±¸ í™˜ì˜í•©ë‹ˆë‹¤.
    ì´ê²Œ ë°”ë¡œ SwiftUIì˜ í˜„ì£¼ì†Œì£ !
    ìœ„ ì˜ˆì œ ì½”ë“œë“¤ì€ ì œ ê¹ƒí—™ì— ì˜¬ë ¤ë†¨ìœ¼ë‹ˆ ì°¸ê³ í•˜ì…”ë„ ì¢‹ìŠµë‹ˆë‹¤ğŸ˜€
    https://github.com/GREENOVER/playground/tree/main/CustomTapGesture

    #### [ì°¸ê³  ìë£Œ]

    https://developer.apple.com/documentation/swiftui/view/ontapgesture(count:coordinatespace:perform:)     https://stackoverflow.com/questions/56513942/how-to-detect-a-tap-gesture-location-in-swiftui

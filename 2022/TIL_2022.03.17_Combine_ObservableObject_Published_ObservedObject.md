## TIL (Today I Learned)

### 3ì›” 17ì¼ (ëª©)   

- #### [í•™ìŠµë‚´ìš©] 
  ### Combine - ObservableObject / @Published / @ObservedObject   
  
  #### ObservableObject?    
  ê³µì‹ë¬¸ì„œì˜ ì •ì˜ëŠ” ê°œì²´ ë³€ê²½ ì „ ë°©ì¶œí•˜ëŠ” ê²Œì‹œìê°€ ìˆëŠ” ê°œì²´ ìœ í˜•ì´ë¼ê³  í•©ë‹ˆë‹¤.   
  ë­”ì†Œë¦¬?!?!??   
  í  ì¼ë‹¨ ì •ì˜ëŠ” ì´ë˜ìš”!      
  ```swift
  protocol ObservableObject : AnyObject
  ```
  í´ë˜ìŠ¤ í”„ë¡œí† ì½œì…ë‹ˆë‹¤.   
  ê·¸ëŸ¬ë‹ˆê¹Œ ìƒê°í•´ë³´ë©´ ì´ í”„ë¡œí† ì½œì„ ë”°ë¥´ëŠ” í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê´€ì°°í•˜ë‹¤ ì–´ë– í•œ ê°’ì´ ë³€ê²½ë˜ë©´ ë·° ì—…ë°ì´íŠ¸ë¥¼ í•´ì¤ë‹ˆë‹¤.   
  ì•„ì§ ê°ì´ ì•ˆì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ í•œë²ˆ ì½”ë“œë¡œ ë³´ì‹œì£ !   
  (ì°¸ê³ ë¡œ, ê³µì‹ë¬¸ì„œì˜ ì½”ë“œ ì „ë¬¸ì…ë‹ˆë‹¤.)   
  ```swift
  class Contact: ObservableObject {
      @Published var name: String
      @Published var age: Int
  
      init(name: String, age: Int) {
          self.name = name
          self.age = age
      }
  
      func haveBirthday() -> Int {
          age += 1
          return age
      }
  }
  
  let john = Contact(name: "John Appleseed", age: 24)
  cancellable = john.objectWillChange
      .sink { _ in
          print("\(john.age) will change")
  }
  print(john.haveBirthday())
  // Prints "24 will change"
  // Prints "25"
  ```
  ì Contactë¼ëŠ” í´ë˜ìŠ¤ê°€ ObservableObject í´ë˜ìŠ¤ í”„ë¡œí† ì½œì„ ë”°ë¦…ë‹ˆë‹¤.   
  ë‚´ë¶€ì—ëŠ” í”„ë¡œí¼í‹° 2ê°œê°€ ìˆëŠ”ë°, ì•ì— ë¶™ì€ @Published ëŠ” ê³§ë°”ë¡œ ì•Œì•„ë³¼ê±°ë‹ˆ ì¼ë‹¨ ë¬´ì‹œ ã„±ã„±!   
  ê·¸ë¦¬ê³  johnì´ë¼ëŠ” Contact ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•˜ì—¬ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.   
  objectWillChangeë¥¼ í†µí•´ ê°œì²´ì˜ ë³€ê²½ì‚¬í•­ì´ ìˆê¸°ì „ì— ë‚´ë³´ë‚´ëŠ” ê²Œì‹œìë¡œ íƒìƒ‰í•´ì¤ë‹ˆë‹¤.   
  ì¦‰ ë§ˆì§€ë§‰ ì½”ë“œì˜ ì¶œë ¥ë¬¸ì„ í†µí•´ haveBirthday ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ age í”„ë¡œí¼í‹° ê°’ì´ ë°”ë€Œì£ ?    
  ê·¸ëŸ¬ë©´ ìš” will change êµ¬ë¬¸ì´ ë¨¼ì € ì¶œë ¥ë˜ê³  ê·¸ë‹¤ìŒ age += 1í•œ ê°’ì´ ì¶œë ¥ë©ë‹ˆë‹¤.   
  ì¦‰ ì´ëŸ¬í•œê±¸ ìš°ë¦¬ëŠ” ë·°ì— ì ìš©í•´ë³¼ ìˆ˜ ìˆì„ê±°ì—ìš”.   
  ë˜í•œ ObservableObjectë¥¼ í•™ìŠµí•˜ë©´ì„œ íŒŒìƒë˜ê²Œ ì¤‘ìš”í•œ ê²ƒì´ @Publishedì™€ @ObservedObjectê°€ ë°ì´í„° ëª¨ë¸ê³¼ ë·°ë¥¼ ë°”ì¸ë”© í• ë•Œ í•„ìš”í•œ ë…€ì„ë“¤ì¸ê±¸ ì•Œê²Œ ë˜ì—ˆì–´ìš”.   
  ê·¸ëŸ¼ ì´ì œ ì´ ì¹œêµ¬ë“¤ì„ íŒŒì•…í•´ë³´ì‹œì£ !   
  
  #### Published   
  ì ê³µì‹ë¬¸ì„œ ê³ ê³ ê³ !   
  ì†ì„±ì„ ê²Œì‹œí•˜ëŠ” ìœ í˜•ì´ë¼ê³  í•©ë‹ˆë‹¤.   
  ```swift
  @propertyWrapper struct Published<Value>
  ```
  ì •ì˜ë¥¼ ë³´ë©´ propertyWrapperì…ë‹ˆë‹¤.   
  @Publishedë¥¼ ë¶™ì—¬ ë§Œë“¤ë©´ ì´ ìœ í˜•ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.  
  ë˜í•œ $ ì˜¤í¼ë ˆì´í„°ë¥¼ ë¶™ì—¬ ê²Œì‹œìì— ì—‘ì„¸ìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ìš”ê²ƒë„ ì—­ì‹œë‚˜ ì½”ë“œë¡œ ê³ ê³ í•˜ì‹œì£ !   
  ```swift
  class Weather {
      @Published var temperature: Double
      init(temperature: Double) {
          self.temperature = temperature
      }
  }
  
  let weather = Weather(temperature: 20)
  cancellable = weather.$temperature
      .sink() {
          print ("Temperature now: \($0)")
  }
  weather.temperature = 25
  
  // Prints:
  // Temperature now: 20.0
  // Temperature now: 25.0
  ```
  Weatherë¼ëŠ” í´ë˜ìŠ¤ì— temperature í”„ë¡œí¼í‹°ì— @Publishedë¥¼ ë¶™ì—¬ ì†ì„± ê²Œì‹œ ìœ í˜•ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.   
  ê·¸ë¦¬ê³  weather ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“­ë‹ˆë‹¤.   
  ê°’ ë³€í™”ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ ì„¤ì •í•´ì£¼ê³  í•´ë‹¹ $temperatureë¥¼ ì´ìš©í•´ ê²Œì‹œìì— ì—‘ì„¸ìŠ¤ í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤.   
  ê·¸ëŸ¬ê³  í•´ë‹¹ ê°’ì„ ë³€í™”ì‹œì¼œì£¼ë©´ ì¶œë ¥ë¬¸ì´ í•´ë‹¹ ê°’ì— ë§ê²Œ ì¶œë ¥ë˜ê²Œ ë©ë‹ˆë‹¤!   
  ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ìƒˆë¡œìš´ ê°’ì´ ì‹¤ì œë¡œ ì„¤ì •ë˜ê¸°ì „ì— ì € sinkë¸”ëŸ­ì´ ì‹¤í–‰ë¨ìœ¼ë¡œ ë‘ë²ˆ í˜„ì¬ê°’ê³¼ ë³€ê²½ê°’ì´ ì¶œë ¥ë˜ê²Œ ë©ë‹ˆë‹¤.    
  ë˜í•œ í•´ë‹¹ ì†ì„±ì€ ì˜¤ì§ í´ë˜ìŠ¤ì—ì„œë§Œ ì“¸ ìˆ˜ ìˆìœ¼ë‹ˆ ìœ ì˜í•´ì£¼ì„¸ìš”ğŸ™‹ğŸ»   
  ì¦‰ ë·°ì™€ ì—°ê²°í•˜ë©´ í•´ë‹¹ ê°’ì´ ë³€í™”í• ë•Œ ë§ˆë‹¤ ì—…ë°ì´íŠ¸ ì‹œì¼œ ì£¼ê² ë„¤ìš”.   
  
  #### OvservedObject    
  ê³µì‹ë¬¸ì„œ ì½”ë“œ ì •ì˜ë¥¼ ë´…ì‹œë‹¤.   
  ```swift
  @propertyWrapper @frozen struct ObservedObject<ObjectType> where ObjectType : ObservableObject
  ```
  ì—­ì‹œë‚˜ propertyWrapperêµ°ìš”.   
  ObservableObject íƒ€ì…ì—ì„œ í•´ë‹¹ë˜ë„¤ìš”.   
  ObservableObjectë¥¼ êµ¬ë…í•˜ë©° ê°’ ì—…ë°ì´íŠ¸ê°€ ë°œìƒí•˜ë©´ ë·°ë¥¼ ê°±ì‹ í•´ì£¼ëŠ” ì¹œêµ¬ì…ë‹ˆë‹¤.   
  ì½”ë“œë¡œ ë³´ì‹œì£ !   
  (ê³µì‹ ë¬¸ì„œì— ì„¤ëª…ê³¼ ì½”ë“œê°€ ì •ë§ ì—†ì–´ì„œ í•œë²ˆ ê°„ë‹¨íˆ ë§Œë“¤ì–´ë´¤ì–´ìš”.   
  ```swift
  class User: ObservableObject {
    @Published var age = 10
  }
  
  struct MainView: View {
    @StateObject var green = User()
  
    var body: some View {
      Text("Age is \(green.age)")
      SubView(user: green)
    }
  }
  
  struct SubView: View {
    @ObservedObject var user: User
  
    var body: some View {
      Button("Plus Age") {
        user.age += 1
      }
    }
  }
  ```
  ì ì´ë ‡ê²Œ ë·°ì— ì ìš©í•©ë‹ˆë‹¤.   
  SubViewì— @ObesrvedObjectë¡œ User í´ë˜ìŠ¤ íƒ€ì…ìœ¼ë¡œ í”„ë¡œí¼í‹°ë¥¼ ì§€ì •í•´ì¤ë‹ˆë‹¤.   
  í•´ë‹¹ í´ë˜ìŠ¤ì—ì„œëŠ”@Published ageë¥¼ ê°€ì§‘ë‹ˆë‹¤.   
  SubViewì—ì„œëŠ” ë²„íŠ¼ì„ ë‘ì–´ í´ë¦­ ì‹œ ageì˜ ê°’ì„ ë³€ê²½í•´ì¤ë‹ˆë‹¤.   
  MainViewì—ì„œëŠ” í•´ë‹¹ User íƒ€ì…ì„ ì°¸ì¡°í•˜ì—¬ í”„ë¡œí¼í‹°ë¥¼ ë§Œë“­ë‹ˆë‹¤.   
  SubViewì— í•´ë‹¹ í”„ë¡œí¼í‹°ë¥¼ ë„˜ê²¨ì£¼ì–´ ì—°ê²°í•´ì¤ë‹ˆë‹¤.   
  ê·¸ëŸ¬ë©´ ë·°ì˜ ì—…ë°ì´íŠ¸ê°€ ê°’ì´ ë°”ë€”ë•Œ ë°”ë¡œ ê°±ì‹ ë˜ë©° ë³´ì—¬ì§€ê²Œ ë˜ê² ë„¤ìš”ğŸ™Œ   
  
  #### ë§ˆë¬´ë¦¬    
  ì´ê±´ ì •ë§ í•´ë´ì•¼ ì•„ëŠ”...   
  ì•„ì£¼ ì‘ê²Œ í”„ë¡œì íŠ¸ë¡œ ì½”ë“œë¥¼ ëŒë ¤ë´ì•¼ ì´í•´ê°€ ì˜ë˜ëŠ” ê·¸ëŸ° ì¹œêµ¬ë“¤ì´ë„¤ìš”!  
  ì–´ë µì§€ ì•Šì€ë° ë‡Œë¡œë§Œ ì´í•´í•˜ë ¤ë©´ ì–´ë ¤ìš´ ì¹œêµ¬ë“¤...  
  í˜ë‚´ë´ìš”ğŸ¤¯   
  
  #### [ì°¸ê³ ìë£Œ]   
  https://green1229.tistory.com/228   
  https://developer.apple.com/documentation/combine/observableobject   
  https://developer.apple.com/documentation/combine/published   
  https://developer.apple.com/documentation/swiftui/observedobject   

## TIL (Today I Learned)

### 1ì›” 23ì¼ (ì¼)   

- #### [í•™ìŠµë‚´ìš©]
  ### fastlaneìœ¼ë¡œ Debug / Release ë¹Œë“œ ìë™ ë°°í¬í•˜ê¸°   
  #### fastlaneì´ ë­ì•¼ ?   
  ê·¸ëŸ¬ê²Œìš”. fastlaneì´ ë­˜ê¹Œìš”?   
  ìš°ì„  ë§ˆí¬ë¶€í„° ì‹ ë°•í•˜ë„¤ìš”ã…‹ã…‹   
  fastlaneì€ iOS ë° Android ì•±ìš© ë² íƒ€ ë°°í¬ ë° ë¦´ë¦¬ìŠ¤ë¥¼ ìë™í™”í•˜ëŠ” ì•„ì£¼ ìœ ìš©í•œ íˆ´ì…ë‹ˆë‹¤.   
  ìŠ¤í¬ë¦°ìƒ· ìƒì„±, ì½”ë“œ ì„œëª… ì²˜ë¦¬, ì• í”Œë¦¬ì¼€ì´ì…˜ ë¦´ë¦¬ìŠ¤ì™€ ê°™ì€ ëª¨ë“  ì¼ë ¨ì˜ ì‘ì—…ë“¤ì„ í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  íŠ¹íˆ ìì£¼ ì €ëŠ” ì‚¬ìš©í•˜ëŠ”ê±´ í…ŒìŠ¤íŠ¸í”Œë¼ì´íŠ¸ ë²„ì „ë‹ê³¼ .dSYM ìë™ ì—…ë¡œë“œ ë“±ì„ ì´ìš©í•©ë‹ˆë‹¤ğŸ¤­   
  ë­ ê·¸ë˜ì„œ ì •ë¦¬í•˜ìë©´ ë°°í¬ë¥¼ ë” í¸ë¦¬í•˜ê²Œ ë„ì™€ì¤€ë‹¤~ ë¼ê³  ìš”ì•½í•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤!   
  
  #### fastlane ì„¤ì¹˜   
  ì €ëŠ” homebrewë¡œ ì„¤ì¹˜í•´ë³´ê² ìŠµë‹ˆë‹¤.   
  ì„¤ì¹˜ë¥¼ ì›í•˜ëŠ” í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ê°€ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.   
  ```
  brew cask install fastlane
  ```
  ë§Œì•½ ê´€ë¦¬ì ê¶Œí•œ í•„ìš”í•˜ë‹¤ ì–´ì©Œê³  í•˜ë©´ ì•ì— sudoë¥¼ ë¶™ì—¬ì£¼ë©´ ë©ë‹ˆë‹¤.   
  (sudoê°€ ë¬´ìŠ¨ ê±°ì˜ ë§ŒëŠ¥ ì½”ë“œ... í•˜ê¸´ ê´€ë¦¬ì ê¶Œí•œì„ ê°€ì ¸ì˜¤ëŠ”ê±°ë‹ˆê¹Œ..ë­.. ì˜ˆ..!)   
  
  #### fastlane ì´ˆê¸° ì„¤ì •   
  í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ fastlaneì„ ì´ˆê¸°í™” í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.   
  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.   
  ```
  fastlane init
  ```
  ê·¸ëŸ¬ë©´ ì´ íŒ¨ìŠ¤íŠ¸ë ˆì¸ì„ ì–´ë”” ì‚¬ìš©í• ê±´ì§€ ë¬¼ì–´ë´ìš”.   
  ì „ í…ŒìŠ¤íŠ¸í”Œë¼ì´íŠ¸ì— ì˜¬ë¦¬ê³  ìì²´ ê²€ìˆ˜í•˜ê³  ì‹¬ì‚¬ìš”ì²­/ì¶œì‹œë¥¼ ì§„í–‰í• ê±°ë¼ 2ë²ˆ í•­ëª©ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.   
  ì´ê±´ ë‚˜ì¤‘ì— ì„¤ì •ì„ ë°”ê¿€ ìˆ˜ ìˆìœ¼ë‹ˆ í¬ê²Œ ê³ ë ¤ëŠ” ì•ˆí•´ë„ë©ë‹ˆë‹¤ğŸ¤­   
  ê·¸ëŸ¬ë©´ ê²½ìš°ì—ë”°ë¼ ì• í”Œ ê³„ì •ì„ ì…ë ¥í•˜ë¼ëŠ” ê³¼ì •ì´ ë‚˜ì˜¤ëŠ”ë° ì´ëŠ” ì•Œì•„ì„œ ë§ê²Œ ì…ë ¥í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤!   
  
  #### fastlane ìƒì„¸ ì„¤ì •   
  ìœ„ ì´ˆê¸° ì„¤ì •ì„ ëëƒˆë‹¤ë©´ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì— fastlane í´ë”ê°€ ìƒê²¨ìš”..!   
  ì—¬ê¸°ì„œ ì¤‘ìš”í•œê±´ Fastfileì…ë‹ˆë‹¤.   
  ì—¬ê¸°ì„œ ìƒì„¸ì ìœ¼ë¡œ ì›í•˜ëŠ” ì„¤ì •ë“¤ì„ í•´ì¤„ê±°ì—ìš”..!   
  ì €ëŠ” ëª©í‘œê°€ í”„ë¡œì íŠ¸ë¥¼ Debugì™€ Release ìŠ¤í‚´ìœ¼ë¡œ ë‚˜ëˆ´ê³  ì´ë¥¼ ê°ê° í˜¹ì€ ê°™ì´ ë°°í¬í•  ìˆ˜ ìˆë„ë¡ fastlane ëª…ë ¹ì–´ë¥¼ í†µí•´ ì›í•˜ëŠ” ë™ì‘ì„ í•´ì£¼ê³  ì‹¶ì–´ìš”.   
  ë¬´ìŠ¨ë§ì´ëƒë©´ í…ŒìŠ¤íŠ¸ ë¹Œë“œì™€ í”„ë¡œë•íŠ¸ ë¹Œë“œë¥¼ ê³¨ë¼ì„œ í…ŒìŠ¤íŠ¸í”Œë¼ì´íŠ¸ì— ì—…ë¡œë“œí•˜ê±°ë‚˜ ë°°í¬í•˜ë ¤í•´ìš”.   
  ì¶”ê°€ë¡œ ë‘ê°œ ëª¨ë‘ í•œ ëª…ë ¹ì–´ë¡œ ë‹¤ í…ŒìŠ¤íŠ¸í”Œë¼ì´íŠ¸ ì—…ë¡œë“œ í˜¹ì€ ë°°í¬ ì‹œí‚¤ê³  ì‹¶ìŠµë‹ˆë‹¤.   
  ì™œ í•„ìš”í•˜ëƒë©´ QAë¥¼ ìœ„í•´ í”„ë¡œë•íŠ¸ ë¹Œë“œì—ì„œ í•´ë³¼ ìˆ˜ ì—†ìœ¼ë‹ˆ í…ŒìŠ¤íŠ¸ ë¹Œë“œë„ ë‹¤ìš´ë°›ì•„ í•´ë³¼ ìˆ˜ ìˆì–´ì•¼ê² ì–´ìš”.   
  ê·¸ëŸ¼ ê±°ë‘ì ˆë¯¸í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ê°„ë‹¨íˆ ë³´ë©´ì„œ ì„¤ì •í•´ë´…ì‹œë‹¤!   
  ```
  platform :ios do
    // Dev + Product ë¹Œë“œ ëª¨ë‘ ì—…ë¡œë“œ
    desc "Push a new beta build to TestFlight"
    lane :beta do
      bump_type = prompt_version_bump_type()
      bump_version(bump_type)
      new_build_number = number_of_commits()
      increment_build_number(build_number: new_build_number)
      commit_version_bump(
        message: ":bookmark: v#{get_version_number()}-#{new_build_number}",
        xcodeproj: "Green.xcodeproj",
        include: %w[Green.xcodeproj/project.pbxproj Green/Info.plist Green.xcworkspace/xcshareddata],
        ignore: /vendor/
      )
      update_app_identifier(
        xcodeproj: "Green.xcodeproj",
        plist_path: "Green/Info.plist",
        app_identifier: "com.Green-dev"
      ) 
      build_app(
        workspace: "Green.xcworkspace",
        scheme: "Green-dev",
        xcargs: "-allowProvisioningUpdates"
      )
      upload_to_testflight(skip_waiting_for_build_processing: true)
      update_app_identifier(
        xcodeproj: "Green.xcodeproj",
        plist_path: "dGreen/Info.plist",
        app_identifier: "com.Green"
      ) 
      build_app(
        workspace: "Green.xcworkspace",
        scheme: "Green",
        xcargs: "-allowProvisioningUpdates"
      )
      upload_to_testflight()
      download_dsyms(version: get_version_number(), build_number: new_build_number.to_s)
      upload_dsym(get_version_number(), new_build_number)
    end
  
    // Product ë¹Œë“œë§Œ ì—…ë¡œë“œ
    desc "Push a new production build to TestFlight"
    lane :prod do
      bump_type = prompt_version_bump_type()
      bump_version(bump_type)
      new_build_number = number_of_commits()
      increment_build_number(build_number: new_build_number)
      commit_version_bump(
        message: ":bookmark: v#{get_version_number()}-#{new_build_number}",
        xcodeproj: "Green.xcodeproj",
        include: %w[Green.xcodeproj/project.pbxproj Green/Info.plist Green.xcworkspace/xcshareddata],
        ignore: /vendor/
      )
      update_app_identifier(
        xcodeproj: "Green.xcodeproj",
        plist_path: "Green/Info.plist",
        app_identifier: "com.Green"
      ) 
      build_app(
        workspace: "Green.xcworkspace",
        scheme: "Green",
        xcargs: "-allowProvisioningUpdates"
      )
      upload_to_testflight()
      download_dsyms(version: get_version_number(), build_number: new_build_number.to_s)
      upload_dsym(get_version_number(), new_build_number)
    end
    
    // Dev ë¹Œë“œë§Œ ì—…ë¡œë“œ
    desc "Push a new dev build to TestFlight"
    lane :dev do
      bump_type = prompt_version_bump_type()
      bump_version(bump_type)
      new_build_number = number_of_commits()
      increment_build_number(build_number: new_build_number)
      commit_version_bump(
        message: ":bookmark: v#{get_version_number()}-#{new_build_number}",
        xcodeproj: "Green.xcodeproj",
        include: %w[Green.xcodeproj/project.pbxproj Green/Info.plist Green.xcworkspace/xcshareddata],
        ignore: /vendor/
      )
      update_app_identifier(
        xcodeproj: "Green.xcodeproj",
        plist_path: "Green/Info.plist",
        app_identifier: "com.Green-dev"
      ) 
      build_app(
        workspace: "Green.xcworkspace",
        scheme: "Green-dev",
        xcargs: "-allowProvisioningUpdates"
      )
      upload_to_testflight()
      download_dsyms(version: get_version_number(), build_number: new_build_number.to_s)
      upload_dsym(get_version_number(), new_build_number)
    end
  end
  ```
  ì´ 3ê°œë¡œ ë‚˜ëˆ´ìŠµë‹ˆë‹¤.   
  1. Dev + Prod ë¹Œë“œ ëª¨ë‘ ë™ì‹œ ì—…ë¡œë“œ   
      fastlane beta ëª…ë ¹ì–´ë¡œ ì‹¤í–‰ ì‹œ íƒ€ì…ê³¼ ë²„ì „ì„ ì²´í¬ í…ŒìŠ¤íŠ¸í•˜ê³  ë¹Œë“œ ë²„ì „ì„ ì»¤ë°‹ìˆ˜ëŒ€ë¡œ í•˜ë‚˜ ì˜¬ë¦½ë‹ˆë‹¤.   
      ê·¸ ë‹¤ìŒ ì¤‘ìš”í•œ ë¶€ë¶„ì´ 3ê°€ì§€ ì…ë‹ˆë‹¤.   
      update_app_identifier() ëª…ë ¹ìœ¼ë¡œ ì•± ìŠ¤í† ì–´ ì»¤ë„¥íŠ¸ ì‚¬ì´íŠ¸ì—ì„œ ë§Œë“¤ì–´ì§„ ì•± ì¦‰ devì™€ prod ì•±ì— ê°ê° ë§¤ì¹­ì„ ìœ„í•´ ì•± ì‹ë³„ìë¥¼ ì—…ë°ì´íŠ¸ í•´ì¤ë‹ˆë‹¤.   
      ê·¸ë˜ì„œ ë¨¼ì € dev ë¹Œë“œë¥¼ ì•± ì‹ë³„ìë¥¼ ì—…ë°ì´íŠ¸ í•´ì£¼ê³  build_app() ëª…ë ¹ì„ í†µí•´ í”„ë¡œì íŠ¸ì—ì„œ ìŠ¤í‚´ì„ ë‚˜ëˆ´ë˜ê±°ì—ì„œ dev ìŠ¤í‚´ì„ ë„£ì–´ì¤ë‹ˆë‹¤.   
      ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ì¤‘ìš”í•œê²ƒì´ í…ŒìŠ¤íŠ¸ í”Œë¼ì´íŠ¸ ì—…ë¡œë“œ ëª…ë ¹ì–´ì¸ upload_to_testflight() ëª…ë ¹ì„ ì£¼ëŠ”ë° ì•ˆì— ì•„ë¬´ ì¡°ê±´ì„ ë„£ì§€ ì•Šìœ¼ë©´ ë¬´í•œì • ë¹Œë“œ ë° ì—…ë¡œë“œ ë˜ëŠ” ê³¼ì •ì„ ê³„ì† ê¸°ë‹¤ë ¤ì•¼í•´ì„œ ë„ˆë¬´ ì˜¤ë˜ê±¸ë¦½ë‹ˆë‹¤...   
      ê·¸ë ‡ê¸°ì— skip_waiting_for_build_processingì„ trueë¡œ ì¡°ê±´ì„ ì•ˆì— ì£¼ì–´ ë¹Œë“œ ê³¼ì •ì€ ìƒëµí•˜ê³  ë‹¤ìŒ ëª…ë ¹ìœ¼ë¡œ ë„˜ì–´ê°€ê²Œ í•©ë‹ˆë‹¤.   
      ê·¸ëŸ¬ë©´ ë™ì¼í•œ ìˆœì„œë¡œ ì•± ì‹ë³„ìë¥¼ prodë¡œ ë°”ê¾¸ê³  í…ŒìŠ¤íŠ¸í”Œë¼ì´íŠ¸ì— ì—…ë¡œë“œí•˜ê³  ë‹¤ ì´ë¤„ì§€ë©´ dSYMì„ ë‹¤ìš´í•˜ê³  ì—…ë¡œë“œí•˜ëŠ” ëª…ë ¹ì„ ìˆ˜í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.   
      ì´ë¡œì¨ devì™€ prodì— ë™ì‹œ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤!   
  2. Dev ë¹Œë“œë§Œ ì—…ë¡œë“œ   
      ìœ„ì™€ ë™ì¼í•œê±°ì—ì„œ prodë§Œ ë¹ ì¡ŒìŠµë‹ˆë‹¤.   
      dev ë¹Œë“œë§Œ ì—…ë¡œë“œ ë©ë‹ˆë‹¤.   
  3. Prod ë¹Œë“œë§Œ ì—…ë¡œë“œ   
      2ë²ˆì˜ ì„¤ëª…ê³¼ ê°™ìŠµë‹ˆë‹¤.   
      prod ë¹Œë“œë§Œ ì—…ë¡œë“œ ë©ë‹ˆë‹¤.   
  
  #### fastlane ì‚¬ìš©   
  ìœ„ ìƒì„¸ ì„¤ì •ê¹Œì§€ ëëƒˆìœ¼ë©´ ì´ì œ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë“¤ë¡œ ë™ì‘ ì‹œì¼œì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ```
  fastlane beta
  fastlane dev
  fastlane prod
  ```
  ë„ˆë¬´ ì‰½ì£ ?   
  ìœ„ 3ê°œì¤‘ ì›í•˜ëŠ” ë™ì‘ì˜ ëª…ë ¹ì–´ë¥¼ í•´ì£¼ì‹œë©´ ì­ˆìš±~~ ì§„í–‰ë©ë‹ˆë‹¤!   
  
  #### ë§ˆë¬´ë¦¬   
  ì•„ì§ ì •ë§ fastlaneì˜ ê¸°ì´ˆ ì¤‘ ê¸°ì´ˆë°–ì— ëª» ì•Œì•„ë´¤ì–´ìš”.   
  ì´ì •ë„ë¡œ ì¶©ë¶„í•˜ì§„ ì•Šì§€ë§Œ ì‹œì‘ì´ ë°˜ì´ë‹ˆê¹Œ..!   
  ë°˜ì€ í–ˆë„¤ìš”ğŸ˜€   
  ì•„ì§ ì €ë„ fastlane ì–´ë¦°ì´ê¸°ì—.. ì¹´í…Œê³ ë¦¬ë¥¼ ì´ì°¸ì— ìƒˆë¡œ íŒŒë´¤ê³  ë” ë§ì€ í¬ìŠ¤íŒ…ì„ í•´ë‚˜ê°€ë ¤í•©ë‹ˆë‹¤ğŸ’ª   
  
  #### [ì°¸ê³ ìë£Œ]   
  https://green1229.tistory.com/211   
  https://docs.fastlane.tools   

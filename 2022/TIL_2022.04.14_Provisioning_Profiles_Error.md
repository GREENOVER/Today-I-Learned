## TIL (Today I Learned)

### 4월 14일 (목)   

- #### [학습내용]    
  ### Provisioning Profiles 오류 해결하기    
  
  갑자기 오늘 빌드를 올리기 위해 fastlane으로 앱 커넥트 사이트에 업로드 하는 도중 PP파일 만료 문제를 만났어요😭   
  뭔 에러야 대체...
  어제까지 잘 되던 빌드 업로드가 한순간에?   
  일단 원인을 파악해보려고 에러 메시지를 봤어요.   
  아니 왜..... 그래서 처음에 fastlane 문제인가 해서 Xcode로 수동 아카이브해서 업로드를 시도해봤어요!   

  ㅎㅎ.. 똑같이 뜨네?   
  그래도 똑같은 에러를 내뱉어요.   
  저 빨간 테두리로 감싸놓은 문구가 아주 중요한 키포인트였습니다🤯   

  "Expired Profile signing certificate"   
  요 메시지가 핵심인것 같았습니다.   
  프로파일 사이닝 인증이 만료되었다..!   

  그래서 우선 개발자 사이트에 해당 profile이 만료된게 있나 확인하로 갔습니다.   
  https://developer.apple.com/account/#!/overview/C5C6SUJ39F     
  없잖아... 아직 다 만료 안됐잖아...   

  근데 대체 왜?   
  아직 정확한 원인은 모르겠는데 저는 아래와 같이 2가지 방법을 통해 해결이 되었어요.  

  #### 1. Keychain   
  키체인 접근으로가서 인증서에서 Apple distribution 해주는 인증서를 삭제했어요.   
  근데 이방법은 아래 2번 방법을 하고 나서 의미가 있었을까라는 생각이 들었습니다.   
  2번의 방법을 거치지 않았을때 초기에 이 방법으로 다시 아카이브했을때 되었는데 여러번 시도 시 또 발생하더라구요🥲   

  그래서 찾은 두번째 방법!   

  #### 2. Provisioning Profiles (일명 pp 파일) 날리기   

  우선 라이브러리 > MobileDevice > Provisioning Profiles 폴더로 갑니다. (~/library/MobileDevice 하위 PP 폴더) 그러면 아래와 같이 프로비저닝 파일들이 쫙 있는걸 볼 수 있어요.   

  얘네가 왜 문제일까 봤는데 만료된 프로비저닝 파일이 존재하는게 문제였던것 같더라구요.   
  만료된 파일과 만료되지 않은 파일들간에 충돌이 나서 엑코에서 이전 만료된 친구를 자꾸 읽는 느낌이였어요.   
  그래서 얘네를 다 날렸습니다.   
  그런데 이전에 만료된 친구들만 날려도 될것 같긴했어요.   
  그래도 어차피 Xcode에서 Signing을 오토매틱하게 해주도록 설정해놨기에 다시 만들겠지~ 하고 다 날렸어요!   
  그러니까 자동으로 다시 프로비저닝 파일을 만들고 아카이브 및 패스트레인이 잘 돌더라구요..!   

  #### 왜 이런일이 발생했을까요 갑자기?   

  일단 저는 이렇게 해결했는데 이후 커뮤니티들에 올라오는 글을 보면   
  단순 저의 문제뿐만 아니라 오늘 많은 분들이 같은 문제를 겪었더라구요?   
  알고 봤더니 애플 내부 인증서가 만료되었던....   
  결국 우리가 하는 방법은 프로비저닝 파일을 다시 만드는것 뿐이였던...   
  애플의 실수 아닌 실수였던것 같습니다!   
  뭐 이제 다시 애플에서 인증서를 연장했기에 2027년까지는 이러한 문제가 발생하지 않을거 같긴하지만?   
  그래도 만약 비슷한 문제를 겪는다면 PP파일부터 체크해봐야겠습니다!   
  이것때문에 오늘 하루 꼬박 보냈네요🥲   

  #### 마무리   

  진짜 별거 아닌걸로 하루를 보낸 소감 최고네요🤪   
  애플 일해라   
  
  #### [참고자료]   
  https://green1229.tistory.com/236   
## TIL (Today I Learned)

### 4ì›” 21ì¼ (ìˆ˜)

- #### [í•™ìŠµë‚´ìš©]

  ì˜¤í”ˆì†ŒìŠ¤ LLDB ìŠ¤í¬ë¦½íŠ¸ì¸ Derek Selanderì— ëŒ€í•œ í•™ìŠµğŸ˜ƒ

  - ì™œ ì˜¤í”ˆì†ŒìŠ¤ LLDB ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì•Œì•„ì•¼í• ê¹Œ?
  
- ì‚¬ì‹¤ ëª°ë¼ë„ ìƒê´€ì—†ë‹¤. ë‹¤ë§Œ ì—¬íƒœ ëª…ë ¹ì–´ë“¤ì„ ë³µì¡í•˜ê²Œ ì¡°í•©í•˜ì—¬ LLDB ëª…ë ¹ì–´ë“¤ì„ ì¼ë˜ ë¶€ë¶„ë“¤ì— ëŒ€í•´ ì˜¤í”ˆì†ŒìŠ¤ì—ì„œëŠ” ì´ë¯¸ ê·¸ëŸ° ëª…ë ¹ì–´ë“¤ì„ ì¢€ ë” í¸ë¦¬í•˜ê²Œ ì“°ë„ë¡ ì¡°í•©í•´ë†¨ê¸°ì— ì“°ë©´ í›¨ì”¬ í¸ë¦¬í• ê²ƒì´ë‹¤!
  
  - ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ê°€ì ¸ë‹¤ ì“°ëŠ” ë°©ë²•
    - HomeBrewë¥¼ í†µí•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´í•˜ì—¬ .lldbinit íŒŒì¼ì— ë„£ëŠ” ë°©ë²•
  - ì˜¤í”ˆì†ŒìŠ¤ ê¹ƒí—™ì„ í´ë¡ í•´ì„œ ê²½ë¡œë¥¼ ê°€ì§€ê³  .lldbinit íŒŒì¼ì— ë„£ëŠ” ë°©ë²•
  
  - .lldbinit íŒŒì¼ì´ë€?
    - lldbë¥¼ ì‹¤í–‰ ì‹œ ì´ˆê¸°íŒŒì¼ë¡œ ì•ì„œ ì„¤ëª…í•œ aliasì™€ ê°™ì´ ì§€ì •í•´ë†“ê³  ì‹¶ê±°ë‚˜ ì•„ë‹ˆë©´ ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ê°€ì ¸ì™€ ì¶”ê°€í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
  - í•´ë‹¹ íŒŒì¼ì€ í™ˆ ë””ë ‰í† ë¦¬ì— ìˆ¨ê²¨ì§„ íŒŒì¼ë¡œ ìœ„ì¹˜í•´ìˆìœ¼ë©° ì—†ë‹¤ë©´ ìƒì„±í•˜ë©´ë¨ğŸ¤–
  
  - Derek Selander ì˜¤í”ˆì†ŒìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ê°€ì ¸ì˜¤ê¸°
    1. https://github.com/DerekSelander/LLDBÂ (ê¹ƒí—™ ì ‘ì†)
    2. í•´ë‹¹ ë ˆíŒŒì§€í† ë¦¬ë¥¼ í´ë¡ í•˜ì—¬ ì›í•˜ëŠ” ìœ„ì¹˜ì— ì €ì¥
    3. ~/.lldbinit íŒŒì¼ ì˜¤í”ˆ
  4. command script import "í´ë¡ ë°›ì€ ê²½ë¡œ"/LLDB/lldb_commands/dslldb.pyë¥¼ íŒŒì¼ì— ì‘ì„± ë° ì €ì¥
  
  - Derek Selander LLDB Script
    - search: íŠ¹ì • í´ë˜ìŠ¤ì˜ ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ í™ ê²€ìƒ‰
    ```
  (lldb) search UIView
	<UIView: 0x7fb7dc008fe0; frame = (0 0; 320 568); autoresize = W+H; 			layer = <CALayer: 0x60000336dc40>>
	<UIWindow: 0x7fb7d9f08050; frame = (0 0; 320 568); gestureRecognizers = 	<NSArray: 0x600003d74e70>; layer = <UIWindowLayer: 0x600003300d80>>
  <UILabel: 0x7fb7dc006eb0; frame = (63 333; 309 286); text = 'Label'; 		opaque = NO; autoresize = RM+BM; userInteractionEnabled = NO; layer = 	<_UILabelLayer: 0x60000100c6e0>>
    ```
    -> UIViewì˜ ì¸ìŠ¤í„´ìŠ¤ ë° ì„œë¸Œí´ë˜ìŠ¤ íƒìƒ‰
    -> -e ì˜µì…˜ì„ ì¤„ê²½ìš° ì„œë¸Œí´ë˜ìŠ¤ëŠ” ë¬´ì‹œí•˜ê³  ì¸ìŠ¤í„´ìŠ¤ë§Œ íƒìƒ‰
    - dclass: í”„ë¡œì„¸ìŠ¤ì˜ ëª¨ë“  NSObject / SwiftObjectê°€ ìƒì†ëœ í´ë˜ìŠ¤ì˜ ì •ë³´ë¥¼ ì¶œë ¥
    ```
    (lldb) dclass
		Dumping classes
		************************************************************
		NSLeafProxy
		NSProxy
		_UIActivityPlaceholderItemProxy
		_UITargetedProxy
		_UIViewServiceUIBehaviorProxy
		_UIViewServiceReplyControlTrampoline
		_UIViewServiceReplyAwaitingTrampoline
		_UIViewServiceImplicitAnimationDecodingProxy
		_UIViewServiceImplicitAnimationEncodingProxy
    ```
    - section: í”„ë¡œì„¸ìŠ¤ì— ì‹¤í–‰ëœ íŒŒì¼/í”„ë ˆì„ì›Œí¬ì˜ Mach-O ì„¸ê·¸ë¨¼íŠ¸ ë°ì´í„° í‘œì‹œ
    ```
    (lldb) section UIKit
		[0x007fff4c464000-0x007fff4c465000] 0x0000001000 UIKit`__TEXT
		[0x007fff84e8a608-0x007fff84e8b608] 0x0000001000 UIKit`__DATA_CONST
		[0x007fffc02ac000-0x007fffc02b1000] 0x0000005000 UIKit`__LINKEDIT
    ```
    - dd: disassemble ëª…ë ¹ì„ ì•Œì•„ë³´ê¸° ì‰½ê²Œ ìƒ‰ìƒìœ¼ë¡œ í‘œì‹œ (í„°ë¯¸ë„ ì „ìš©)
    - lookup: í•´ë‹¹ ë©”ì„œë“œë¥¼ í¬í•¨í•˜ëŠ” ëª¨ë“  ë©”ì„œë“œ ì¶”ì  (image lookup ê¸°ëŠ¥ê³¼ ë¹„ìŠ·)
    ```
    (lldb) lookup viewDidLoad
		****************************************************
		2 hits in: LLDB
		****************************************************
		LLDB.ViewController.viewDidLoad() -> ()
		@objc LLDB.ViewController.viewDidLoad() -> ()
		****************************************************
		8 hits in: DocumentManager
		****************************************************
		-[UIDocumentBrowserViewController viewDidLoad]
		-[DOCRemoteViewController viewDidLoad]
		-[DOCTargetSelectionBrowserViewController viewDidLoad]
    ```
    ```
		(lldb) lookup viewDidLoad -s
		2 hits in: LLDB
		8 hits in: DocumentManager
		49 hits in: UIKitCore
		9 hits in: ShareSheet
		1 hits in: WebCore
		1 hits in: GLKit
		41 hits in: MapKit
		43 hits in: ContactsUI
		12 hits in: OnBoardingKit
    ```
    -> -s ì˜µì…˜ì„ ì£¼ì–´ ì¶•ì•½í•˜ì—¬ ì¶œë ¥
    
  - Derek Selander LLDB Command
    - ls: ì‹¤í–‰ì¤‘ì¸ ì•±ì˜ ê¸°ê¸°ì˜ ë””ë ‰í† ë¦¬ë¥¼ ì¶œë ¥ -> (lldb) ls "ì°¾ìœ¼ë ¤ëŠ” ë””ë ‰í† ë¦¬ ê²½ë¡œ"
    ```
    (lldb) ls /
		(
			home,
			usr,
			bin,
			sbin,
			".file",
			etc,
			var,
			Library,
	  ```
	
	  ```
		(lldb) ls /System/Library
		(
		"Image Capture",
		Receipts,
		Assistant,
		DirectoryServices,
		StartupItems,
    ```
    - reload_lldbinit: lldbinit íŒŒì¼ì˜ ë‚´ìš©ì„ ë‹¤ì‹œë¡œë“œ (Xcode ì¬ì‹œì‘ ì—†ì´ë„ ê°€ëŠ¥)
    ```
    (lldb) reload_lldbinit
		Executing commands in '/Users/chanwoo/.lldbinit'.
		command script import 		/Users/chanwoo/Desktop/LLDB/lldb_commands/dslldb.py
		command script import /usr/local/opt/chisel/libexec/fbchisellldb.py
    ```
    - tv:Â í˜„ì¬ ë·°ì—ì„œ íˆë“ ëœ ê°’ì„ ì „í™˜
    ```
    (lldb) tv [UIView new]
    ```
    - pprotocol: í•´ë‹¹ í”„ë¡œí† ì½œì— ëŒ€í•œ ëª¨ë“  ë©”ì„œë“œ ì •ë³´Â ì¶œë ¥
    ```
    (lldb) pprotocol UITableViewDataSource
		Protocol: UITableViewDataSource, <Protocol: 0x7fff8a4b0328>
		==========================================
		 (Required)
		- tableView:numberOfRowsInSection:, q32@0:8@16q24
		- tableView:cellForRowAtIndexPath:, @32@0:8@16@24
		 (Optional)
		- numberOfSectionsInTableView:, q24@0:8@16
		- tableView:titleForHeaderInSection:, @32@0:8@16q24
		- tableView:titleForFooterInSection:, @32@0:8@16q24
		- tableView:canEditRowAtIndexPath:, B32@0:8@16@24
		- tableView:canMoveRowAtIndexPath:, B32@0:8@16@24
		- sectionIndexTitlesForTableView:, @24@0:8@16
		- tableView:sectionForSectionIndexTitle:atIndex:, q40@0:8@16@24q32
		- tableView:commitEditingStyle:forRowAtIndexPath:, v40@0:8@16q24@32
		- tableView:moveRowAtIndexPath:toIndexPath:, v40@0:8@16@24@32
    ```
    - pframework: í”„ë ˆì„ì›Œí¬ ìœ„ì¹˜ ì¶œë ¥
    ```
    (lldb) pframework UIKit
		"/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Library/Developer/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/Frameworks/UIKit.framework/UIKit"
    ```
    - sys: ëª…ë ¹ ì‹¤í–‰ì„ ìœ„í•œ ì‰˜ë¡œ ì´ë™ (ì‰˜ ëª…ë ¹ì–´ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ LLDB ì½˜ì†”ì—ì„œ)
    - methods: ê°ì²´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ë©”ì„œë“œ ì •ë³´ ì¶œë ¥
    ```
    (lldb) methods UIView
		<UIView: 0x7fff86f664a0>:
		in UIView:
			Class Methods:
				+ (id) fallback_debugHierarchyChildGroupingID; (0x10ddd9129)
				+ (id) fallback_debugHierarchyAdditionalGroupingIDs; 	(0x10ddd9136)
				+ (id) fallback_debugHierarchyObjectsInGroupWithID:(id)arg1 		onObject:(id)arg2 outOptions:(id*)arg3; (0x10ddd91be)
				+ (id) fallback_debug
    ```
    - ivars: NSObjectì—ì„œ ìƒì†ëœ ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ëª¨ë“  ë³€ìˆ˜ì •ë³´Â ì¶œë ¥
    ```
    (lldb) ivars [UIView new]
		userInteractionDisabled (b1): NO
				implementsDrawRect (b1): NO
				implementsDidScroll (b1): NO
				implementsMouseTracking (b1): NO
				implementsIntrinsicContentSize (b1): NO
				hasBackgroundColor (b1): NO
    ```
    - dumpenv: í”„ë¡œì„¸ìŠ¤ í™˜ê²½ ë³€ìˆ˜ ì •ë³´ ì¶œë ¥
    - keychain: í”„ë¡œì„¸ìŠ¤ ê´€ë ¨ í‚¤ì²´ì¸ DB ì •ë³´ ì¶œë ¥
    ```
    (lldb) keychain
		<__NSArrayM 0x600001fb1590>(
		{
		acct = "localdevice-AuthToken";
		agrp = apple;
		"v_Data (str)" = "A8CD94D2-13E3-40B...
    ```
  **"ì´ì™¸ì—ë„ info / lsof ë“± ë‹¤ì–‘í•œ ëª…ë ¹ì–´ê°€ ì¡´ì¬!"**

- #### [ëŠë‚€ì ]
  
  ì—¬íƒœê¹Œì§€ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ì–´ ì‚¬ìš©í•˜ëŠ” LLDB ëª…ë ¹ì–´ë¥¼ ìµí˜”ì„ë•Œë„ ì´ê±¸ ì–¸ì œ ë‹¤ ì™¸ìš°ì§€ ë˜ëŠ” ì´ê±¸ ì–´ë–¤ ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ì¡°í•©í•´ì„œ ì‚¬ìš©í• ê¹Œ ì˜€ëŠ”ë° ê·¸ëŸ° ê±±ì •ë“¤ì„ í•´ê²°í•´ì¤„ ìˆ˜ ìˆëŠ”ê²Œ ì˜¤í”ˆì†ŒìŠ¤ë¼ê³  ëŠê»´ì¡Œë‹¤. íŠ¹íˆ Derek Selanderì˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©° tv / ls / pprotocol ëª…ë ¹ì–´ëŠ” ì§€ê¸ˆ ë‚´ ìƒí™©ì— ë” ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤. ì •ë§ ë§ì€ LLDBë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆì†ŒìŠ¤ê°€ ìˆê² ì§€ë§Œ ìš°ì„  ê¸°ë³¸ì— ì¶©ì‹¤í•˜ê³  ì˜¤ëŠ˜ ë°°ìš´ ì˜¤í”ˆì†ŒìŠ¤ì™€ ë·° ë””ë²„ê¹…ì— ìœ ìš©í•œ Chiselê¹Œì§€ë§Œ ìš•ì‹¬ë‚´ì„œ í•´ë³´ê³  ë‹¤ì ¸ë´ì•¼ê² ë‹¤ğŸ§
  
  
  
- #### [ì°¸ê³ ìë£Œ]
  https://github.com/DerekSelander/LLDB
  
  https://yagom.net/courses/start-lldb/
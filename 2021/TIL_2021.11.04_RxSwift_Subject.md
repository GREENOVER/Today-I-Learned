## TIL (Today I Learned)

### 11ì›” 4ì¼ (ìˆ˜)

- #### [í•™ìŠµë‚´ìš©]
  
  #### RxSwift - Subject?!   

  ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ Observableì„ í•™ìŠµí•˜ë©´ì„œ ì´ë²¤íŠ¸ë¥¼ ë§Œë“¤ê³  êµ¬ë… ë° disposeí•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤!         
  ë‹¤ì‹œ ë§í•˜ì§€ë§Œ ì•„ë˜ ë§í¬ì—ì„œ í•™ìŠµì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤ğŸ§   
  https://github.com/fimuxd/RxSwift/blob/master/Lectures/03_Subjects/Ch3.%20Subjects.md    
  ê·¸ëŸ°ë° ë§ì€ ì½”ë“œì—ì„œëŠ” ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•˜ê³  ë°©ì¶œí•˜ëŠ”ê²ƒì„ í•  ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.   
  ì´ë¥¼ ìœ„í•´ Subjectë¼ëŠ” ê°œë…ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤.   
  ê·¸ëŸ¼ ìì„¸íˆ ì•Œì•„ë³¼ê»˜ìš”ğŸ™Œ   
  
  #### Subject?   

  Observableì´ì Observerì¸ ê²ƒì„ Subjectë¼ í•©ë‹ˆë‹¤.   
  Observableì€ unicastë¡œ í•˜ë‚˜ì˜ Observerë§Œ subscribeí•  ìˆ˜ ìˆì§€ë§Œ   
  SubjectëŠ” multicastë¡œ ì—¬ëŸ¬ê°œì˜ Observerë¥¼ subscribeí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

  #### ì¡°ê¸ˆ ë” ìì„¸íˆ ë“¤ì–´ê°€ë³¸ Observableê³¼ Subjectì˜ ì°¨ì´   
  #### Observable   
  ë‹¨ì¼ í•¨ìˆ˜ë¡œ ìƒíƒœë¥¼ ê°€ì§€ì§€ ì•Šê³  êµ¬ë…í•˜ëŠ” Observerì— ë§¤ë²ˆ ìƒì„±í•˜ëŠ” createë¥¼ ì‚¬ìš©í•´ ì‹¤í–‰í•´ì¤ë‹ˆë‹¤.   
  ì´ë ‡ê²Œ ê° Observerì— ëŒ€í•´ ìƒì„±ë˜ê³  ì‹¤í–‰ë˜ì„œ ë²„ê·¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ```swift
  let randomObservable = Observable<Int>.create{ observer in
    observer.onNext(Int.random(in: 0 ..< 10))
    return Disposables.create()
  }
  
  randomObservable.subscribe(onNext: { (num) in
    print("\(num)")
  })
  randomObservable.subscribe(onNext: { (element) in
    print("\(num)")
  })
  
  // 3
  // 7
  ```
  ìœ„ ì½”ë“œê°™ì´ ë§¤ë²ˆ êµ¬ë… ì‹œ ìƒì„±í•˜ì—¬ ë§Œë“¤ì–´ì£¼ë‹ˆ ë‹¤ë¥¸ ê°’ì„ ë°©ì¶œí•˜ê²Œ ë©ë‹ˆë‹¤.   
  #### Subject   
  Observer ì •ë³´ë¥¼ ì €ì¥í•´ í•œë²ˆì˜ ì‹¤í–‰ìœ¼ë¡œ ì—¬ëŸ¬ Observerì—ê²Œ ê²°ê³¼ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.   
  ```swift
  let randomObservable = BehaviorSubject(value: 0)
  randomObservable.onNext(Int.random(in: 0..<10))
  
  randomObservable.subscribe(onNext: { (num) in
    print("\(num)")
  })
  randomObservable.subscribe(onNext: { (element) in
    print("\(num)")
  })
  
  // 5
  // 5
  ```
  ìœ„ ì½”ë“œëŠ” Observerì˜ ì •ë³´ë¥¼ ì €ì¥í•¨ìœ¼ë¡œ ë™ì¼í•œ ê²°ê³¼ë¥¼ ë°©ì¶œí•©ë‹ˆë‹¤.   

  ë‘˜ì˜ ì°¨ì´ë¥¼ ë‹¤ì‹œ ì •ë¦¬í•´ë³´ë©´ ìƒíƒœë¥¼ ê°€ì§€ê³  ì €ì¥í•˜ëŠ” ìœ ë¬´ë¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ê·¸ë¡œì¸í•´ ì—¬ëŸ¬ ì˜µì €ë²„ì— ëŒ€í•´ ê°™ì€ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëƒ ì•ˆí•˜ëƒì˜ ì°¨ì´ë¥¼ ë³¼ ìˆ˜ ìˆìœ¼ë©°   
  ê·¸ë ‡ê¸°ì— SubjectëŠ” Observableí•˜ë©´ì„œ ê·¸ ê°’ì„ ê´€ì°°í•  ìˆ˜ ìˆëŠ” Observerê°€ ë˜ëŠ”ê²ƒì…ë‹ˆë‹¤.   
  ì—¬ëŸ¬ ì˜µì €ë²„ê°€ í•˜ë‚˜ì˜ ë°ì´í„°ë¥¼ ë°”ë¼ë³´ë©° ìˆ˜ì‹œë¡œ ì €ì¥ ë° ë³€ê²½ë ë•Œ Subjectë¥¼ ì“¸ ìˆ˜ ìˆì–´ì•¼í•©ë‹ˆë‹¤.   

  #### Subject ì¢…ë¥˜   

  4ê°€ì§€ì˜ Subject íƒ€ì…ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.   
  1. PublishSubject   
  ì´ˆê¸°ê°’ì´ ì—†ìœ¼ë©° ìƒˆë¡œìš´ ê°’ë§Œ subscribeì— ë°©ì¶œ   
  2. BehaviorSubject   
  ì´ˆê¸°ê°’ì„ ê°€ì§€ë©° subscriberì—ê²Œ ì´ˆê¸°ê°’ í˜¹ì€ ìƒˆë¡œìš´ ê°’ì„ ë°©ì¶œ   
  3. ReplaySubject   
  ì´ˆê¸°í™” ì‹œ ë²„í¼ë¥¼ ê°€ì§€ë©° ë²„í¼ ì‚¬ì´ì¦ˆë§Œí¼ ê°’ì„ ê°€ì§€ë©´ì„œ subscriberì— ë°©ì¶œ   
  4. Variable   
  BehaviorSubjectë¥¼ ë˜í•‘í•´ í˜„ì¬ ê°’ìœ¼ë¡œ ìƒíƒœ ë³´ì¡´í•˜ë©° ì´ˆê¸° í˜¹ì€ ìƒˆë¡œìš´ ê°’ì„ subscriberì— ë°©ì¶œ   

  ê·¸ëŸ¬ë©´ ì´ì œ 4ê°€ì§€ì˜ Subejctì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ë©´ì„œ ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ ë³´ê² ìŠµë‹ˆë‹¤ğŸ’ğŸ»    

  #### PublishSubject   
  êµ¬ë… í›„ Observableì´ ë°©ì¶œí•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬ ë°›ìŒ   
  ë‹¤ë¥¸ Observerê°€ ê°ê¸° ë‹¤ë¥¸ ì‹œì ì— êµ¬ë…í•œë‹¤ë©´ êµ¬ë…ë˜ëŠ” ì‹œì ì— ë”°ë¼ ì´ì „ê²ƒì€ ë°›ì§€ ëª»í•©ë‹ˆë‹¤.   
  ìŒ.. ì½”ë“œë¡œ ë³´ì‹œì£ !   
  ```swift
  let subject = PublishSubject<Int>()
  let disposeBag = DisposeBag()
  
  subject.subscribeNext { 
    print("First Observer is \($0)")
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(1))
  subject.on(.Next(2))
  
  subject.subscribeNext { 
    print("Second Observer is \($0)") 
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(3))
  subject.onCompleted()
  
  // First Observer is 1
  // First Observer is 2
  // Second Observer is 3
  // First Observer is 3
  ```
  ìœ„ì™€ ê°™ì´ ì½”ë“œë¡œ ë³´ë©´ ì¢€ ë” ì´í•´ê°€ ë˜ì‹¤ê±°ì—ìš”.   
  ì²˜ìŒ êµ¬ë… í›„ 1ê³¼ 2ë¥¼ ë°›ì•˜ê³  ê·¸ë‹¤ìŒ êµ¬ë… í›„ 3ì„ ë°›ì•˜ì–´ìš”.   
  ì´ë ‡ê²Œ ë˜ë©´ 1ê³¼ 2ëŠ” ì²˜ìŒ êµ¬ë… í”„ë¦°íŠ¸ë¬¸ì—ë§Œ ì ìš©ë˜ê³  ë‘ë²ˆì§¸ êµ¬ë…í•œ ë¶€ë¶„ì—ì„œëŠ” 1ê³¼ 2ë‹¤ìŒì— ì´ë¤„ì¡Œê¸°ì— í”„ë¦°íŠ¸ê°€ ë˜ì§€ ì•Šì£ .   
  completed í˜¹ì€ errorë¡œ Subjectë¥¼ ëë‚´ì§€ ì•ŠëŠ” ì´ìƒ ê³„ì† ì‚´ì•„ìˆê²Œ ë©ë‹ˆë‹¤.   

  #### PublishSubject ìš©ë„   
  ì–´ë–¨ë•Œ ì“°ì¼ ìˆ˜ ìˆì„ê¹Œìš”?   
  ì‹¤ì‹œê°„ì— í•„ìš”í•œ ë°ì´í„° í”„ë¡œì íŠ¸ì— ì“°ì¼ ìˆ˜ ìˆì„ê²ë‹ˆë‹¤.   
  ì˜ˆë¥¼ë“¤ì–´ ë§ˆê°ì„ë°• ê°™ì€ ê²½ìš°ë¥¼ ë³´ë©´ 1ì‹œ ê¸°ì¤€ìœ¼ë¡œ ë§ˆê°ë˜ëŠ” ì‚¬í•­ì— ëŒ€í•´ ì´ì „ì— ë“¤ì–´ì˜¨ ìœ ì €ì—ê² ì•Œë ¤ì¤˜ì•¼í•˜ì§€ë§Œ ë§ˆê° í›„ ë“¤ì–´ì˜¤ëŠ” ìœ ì €ì—ê²ŒëŠ” ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•  í•„ìš”ê°€ ì—†ì„ê²ë‹ˆë‹¤.   
  ê·¸ëŸ´ë•Œ ìœ ìš©í•˜ê²Œ ì“°ì¼ ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.   

  #### BehaviorSubject   

  ì´ˆê¸°ê°’ì„ ê°€ì§€ê³  ì´í›„ êµ¬ë…ë˜ëŠ”ê²ƒì— ëŒ€í•´ì„œ ìµœê·¼ ê°’ì„ ë°©ì¶œí•©ë‹ˆë‹¤.   
  ì´ê²ƒë˜í•œ ì½”ë“œë¡œ ë³´ì‹œì£ !   
  ```swift
  let subject = BehaviorSubject(value: 1)
  let disposeBag = DisposeBag()
  
  subject.subscribeNext { 
    print("First Observer is \($0)")
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(2))
  subject.on(.Next(3))
  
  subject.subscribeNext { 
    print("Second Observer is \($0)") 
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(4))
  subject.onCompleted()
  
  // First Observer is 1
  // First Observer is 2
  // First Observer is 3
  // Second Observer is 3
  // First Observer is 4
  // Second Observer is 4
  ```
  ì²˜ìŒì— ì´ˆê¸°ê°’ 1ì„ ê°€ì§€ê³  êµ¬ë… ì‹œ ë°©ì¶œí•´ìš” ê·¸ë¦¬ê³  publishSubjectì™€ ë™ì¼í•˜ê²Œ ì§„í–‰í•˜ë‹¤ ë‘ë²ˆì§¸ êµ¬ë… ì‹œ ìµœê·¼ê°’ì¸ 3ì„ ë°©ì¶œí•´ì£¼ê³  ë˜ ì§„í–‰ë˜ëŠ” ì‚¬ì´í´ì…ë‹ˆë‹¤.   

  #### BehaviorSubject ìš©ë„   
  ì´ˆê¸°ê°’ í˜¹ì€ ê°€ì¥ ìµœê·¼ê°’ì„ ê°€ì§€ê³  ìˆìœ¼ë‹ˆ ë¯¸ë¦¬ ë°ì´í„°ë¥¼ íŒ¨ì¹˜í• ë•Œ ìœ ë¦¬í•©ë‹ˆë‹¤.   
  í™”ë©´ì„ ë¯¸ë¦¬ êµ¬ì„±í•˜ê±°ë‚˜ í• ë•Œ ë¡œë”© ì‹œ í•´ë‹¹ ì‘ì—…ì„ í•´ì¤€ë‹¤ë©´ ìµœê·¼ê°’ë“¤ë¡œ ë¯¸ë¦¬ ì±„ì›Œë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   

  #### RelaySubject   

  êµ¬ë…ì „ì— ë²„í¼ ì‚¬ì´ì¦ˆ ë§Œí¼ ê°’ì„ ì €ì¥í–ˆë‹¤ êµ¬ë… ì‹œ í•´ë‹¹ ì‚¬ì´ì¦ˆë§Œí¼ ê°’ì„ ë°©ì¶œí•´ì£¼ê³  ì‹œì‘ë©ë‹ˆë‹¤.    
  ë²„í¼ í¬ê¸°ê°€ 0ì´ë©´ publishSubjectì™€ ë‹¤ë¥¼ê²Œ ì—†ìŠµë‹ˆë‹¤.   

  ì´ê±´ ì½”ë“œë¡œ ë” ì˜ ì´í•´ê°€ ë í…Œë‹ˆ ì½”ë“œ ë³´ì‹œì£ !   
  ```swift
  let subject = ReplaySubject<Int>.create(bufferSize: 2)
  let disposeBag = DisposeBag()
  
  subject.subscribeNext { 
    print("First Observer is \($0)")
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(1))
  subject.on(.Next(2))
  
  subject.subscribeNext { 
    print("Second Observer is \($0)") 
  }
  .addDisposableTo(disposeBag)
  
  subject.on(.Next(3))
  subject.onCompleted()
  
  // First Observer is 1
  // First Observer is 2
  // Second Observer is 1
  // Second Observer is 2
  // First Observer is 3
  // Second Observer is 3
  ```
  ìš”ëŸ° ëŠë‚Œ~!   
  ë²„í¼ ì‚¬ì´ì¦ˆë§Œí¼ ì§€ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤ğŸ™Œ   

  #### ReplaySubject ìš©ë„   
  ì´ê²ƒì€ ìµœê·¼ê²€ìƒ‰ì–´ì— ë¹„êµë¥¼ í•´ë³´ë©´ ì¢‹ì„ê²ƒ ê°™ìŠµë‹ˆë‹¤.   
  ì›í•˜ëŠ” í¬ê¸°ë§Œí¼ ìµœê·¼ ê²€ìƒ‰í•œê²ƒì— ëŒ€í•´ ì¦‰ 10ê°œê¹Œì§€ ë³´ì—¬ì¤€ë‹¤ë¼ê³  ì¹˜ë©´ ì‚¬ì´ì¦ˆë¥¼ 10ìœ¼ë¡œ ì£¼ê³  ì„¤ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ì´ëŸ° ì´ë²¤íŠ¸ë“¤ êµ¬ì„±ì— íŠ¹í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.   

  #### Variable   

  BehaviorSubjectë¥¼ ë˜í•‘í–ˆê¸°ì— ì´ˆê¸°ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©° ë™ì¼í•œ ë™ì‘ì„ í•´ì£¼ì§€ë§Œ completedë‚˜ error ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤. ë‹¤ ì´ë²¤íŠ¸ê°€ ë°©ì¶œë˜ê³  Variableì´ í•´ì œë˜ë©´  ìë™ completed ì´ë²¤íŠ¸ë¥¼ ë°©ì¶œí•©ë‹ˆë‹¤.   
  ì½”ë“œë¡œ ë³´ë©´ ì´ë ‡ìŠµë‹ˆë‹¤.   
  ```swift
  let variable = Variable(1)
  let disposeBag = DisposeBag()
  
  variable.asObservable().subscribe { 
    print("First Observer is \($0)")
  }
  .addDisposableTo(disposeBag)
  
  variable.value = 2
  variable.value = 3
  
  variable.asObservable().subscribet { 
    print("Second Observer is \($0)") 
  }
  .addDisposableTo(disposeBag)
  
  variable.value = 4
  
  // First Observer is Next(1)
  // First Observer is Next(2)
  // First Observer is Next(3)
  // Second Observer is Next(3)
  // First Observer is Next(4)
  // Second Observer is Next(4)
  // First Observer is Completed
  // Second Observer is Completed
  ```
  BehaviorSubjectì™€ ê±°ì˜ ë™ì¼í•¨ìœ¼ë¡œ ì´í•´ê°€ ì¢€ ë” ì˜ë˜ì—ˆìŠµë‹ˆë‹¤!   

  #### ë§ˆë¬´ë¦¬í•˜ë©°   

  ì´ë²ˆì—ëŠ” ì´ë ‡ê²Œ Subjectì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ì–´ìš”!   
  ì •ë§ ì •ë§ ì•„ì§ê¹Œì§€ë„ í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„ íˆ¬ì„±ì´ì˜€ë‹¤ê³  ëŠê»´ì§€ëŠ”ë° ê·¸ë˜ë„ ì ‘ê·¼í•˜ê³  ê°ì„ ì¡ì€ê²ƒ ê°™ì•„ ë§Œì¡±í•©ë‹ˆë‹¤!   
  ê°€ì¥ ì¤‘ìš”í•œê±´ ë‹¤ì‹œ ê¸°ì´ˆë¡œ ëŒì•„ê°€ Subjectê°€ Observableí•˜ê³  ì–´ë–¤ ì°¨ì´ì¸ì§€ ê·¸ê±¸ ìºì¹˜í•˜ëŠ”ê²ƒì„ ìœ„í•´ ë‹¬ë ¤ì™”ì–´ìš”.   
  ê·¸ê²ƒë§Œ ìºì¹˜í•œë‹¤ë©´ Subject ì´í•´ëŠ” ë‹¤í•œê±°ë¼ê³  ìƒê°í•©ë‹ˆë‹¤ğŸ‘   

  #### [ì°¸ê³ ìë£Œ]   
  https://green1229.tistory.com/188   
  https://sujinnaljin.medium.com/rxswift-subject-99b401e5d2e5      
  https://github.com/fimuxd/RxSwift/blob/master/Lectures/03_Subjects/Ch3.%20Subjects.md   
  http://minsone.github.io/programming/reactive-swift-subject   

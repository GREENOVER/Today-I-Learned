## TIL (Today I Learned)

### 10ì›” 6ì¼ (ìˆ˜)

- #### [í•™ìŠµë‚´ìš©]
  
  ### RxSwift - Buffer & Windowì— ëŒ€í•˜ì—¬ ğŸ§‘ğŸ»â€ğŸ’»   
  
  #### Buffer   

  ##### Bufferë€?   
  BufferëŠ” ì˜µì €ë²„ë¸”ì—ì„œ ë°©ì¶œí•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ë²ˆë“¤ë¡œ í•œë²ˆì— ë¬¶ì–´ì„œ ë¬¶ìŒìœ¼ë¡œ ë°©ì¶œí•˜ê²Œ í•´ì¤ë‹ˆë‹¤.   

  ##### Bufferì˜ ì„ ì–¸   
  ```swift
  import RxSwift
  
  public func buffer(
      timeSpan: RxTimeInterval, 
      count: Int, 
      scheduler: SchedulerType
      ) -> Observable<[Element]> {
      BufferTimeCount(
          source: self.asObservable(), 
          timeSpan: timeSpan, 
          count: count, 
          scheduler: scheduler
      )
  }
  ```
  íŒŒë¼ë¯¸í„° ì‹œê·¸ë‹ˆì³ë¥¼ íŒŒì•…í•´ë³´ê² ìŠµë‹ˆë‹¤.   
  - timeSpan   
  ì–´ëŠì •ë„ì˜ ì¼ì •ì‹œê°„ì˜ ê°„ê²© íƒ€ì„ì„ ì¤„ê²ƒì¸ì§€ì— ëŒ€í•´ timeSpanì„ ë°›ìŠµë‹ˆë‹¤.   
  í•´ë‹¹ timeSpanì´í›„ ë¬¶ì—¬ì§„ ì´ë²¤íŠ¸ ë¬¶ìŒì´ ë°©ì¶œë©ë‹ˆë‹¤.   
  ì¦‰ ì´ timeSpanì´ë€ê²ƒì€ í•­ëª©ì„ ìˆ˜ì§‘í•˜ëŠ” ì‹œê°„ì„ ëœ»í•©ë‹ˆë‹¤.   
  - count   
  ë²„í¼ ë²ˆë“¤ì— ìµœëŒ€ ëª‡ê°œê¹Œì§€ì˜ ìš”ì†Œë¥¼ ë‹´ì„ì§€ë¥¼ ê²°ì •í•´ì¤ë‹ˆë‹¤.   
  countë¡œ ì •í•´ì¤€ ìš”ì†Œì˜ ê°¯ìˆ˜ë§Œí¼ ìˆ˜ì§‘ì´ ë˜ì§€ ì•Šë”ë¼ë„ timeSpanì´ ëë‚˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤.   
  - scheduler   
  í•´ë‹¹ ì—°ì‚°ìê°€ ì‹¤í–‰ë  ì“°ë ˆë“œë¥¼ ê²°ì •í•´ì¤ë‹ˆë‹¤.   
  ì •ë¦¬í•´ë³´ë©´ ìœ„ì˜ 3ê°€ì§€ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ ì˜µì…˜ì„ ì •í•˜ê³  ì˜µì €ë²„ë¸”ì˜ ì–´ë ˆì´ë¥¼ ë°˜í™˜í•´ì£¼ëŠ” ê¸°ëŠ¥ì„ í•´ì¤ë‹ˆë‹¤.   

  ##### Bufferì˜ ì‚¬ìš©   
  ```swift
  import RxSwift
  
  Observable<Int>
  .interval(
      .seconds(1), 
      scheduler: MainScheduler.instance
  )
  .buffer(
      timeSpan: .seconds(2), 
      count: 2, 
      scheduler: MainScheduler.instance
  ) 
  .take(3) 
  .subscribe { 
      print($0) 
  } 
  .disposed(by: disposeBag)
  
  // OutPut
  [0, 1]
  [2, 3]
  [4, 5]
  ```
  ì œê°€ ì¢€ ê°€ë¡œë¡œ ëŠ˜ì–´ì§€ëŠ”ê±¸ ë³„ë¡œ ì•ˆì¢‹ì•„í•´ ì„¸ë¡œë¡œ ì¢€ ë³´ê¸°ì‰½ê²Œ ì»¨ë²¤ì…˜ì„ ë§ì·„ìŠµë‹ˆë‹¤.   
  ìš°ì„  ìœ„ì™€ ê°™ì´ 1ì´ˆë§ˆë‹¤ ì˜µì €ë²„ë¸”ì´ ë°©ì¶œë˜ê²Œ í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.   
  ê·¸ë¦¬ê³  ë²„í¼ë¥¼ í†µí•´ 2ì´ˆë™ì•ˆ ìµœëŒ€ 2ê°œì˜ í•­ëª©ì„ ìˆ˜ì§‘í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•´ì¤ë‹ˆë‹¤.   
  ë˜í•œ takeë¡œ 3ê°œê¹Œì§€ë§Œ ê°€ì ¸ì˜¤ë„ë¡ í•´ì¤ë‹ˆë‹¤.   
  ì´ë ‡ê²Œ ëŒë ¤ë³´ë©´ ì•„ì›ƒí’‹ì´ 2ê°œì˜ í•­ëª©ì”© ë°°ì—´ë¡œ ë¬¶ì—¬ ë°©ì¶œë˜ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ë§Œì•½ ì—¬ê¸°ì„œ ì•„ë˜ì™€ ê°™ì´ timeSpanì„ ì—¬ìœ ë¡­ê²Œ ë³€ê²½í•´ë³´ë„ë¡ í•˜ì£ !   
  ```swift
  import RxSwift
  
  Observable<Int>
  .interval(
      .seconds(1), 
      scheduler: MainScheduler.instance
  )
  .buffer(
      timeSpan: .seconds(10), 
      count: 2, 
      scheduler: MainScheduler.instance
  ) 
  .take(3) 
  .subscribe { 
      print($0) 
  } 
  .disposed(by: disposeBag)
  
  // OutPut
  [0, 1]
  [2, 3]
  [4, 5]
  ```
  timeSpanì„ 10ì´ˆë¡œ ë³€ê²½í•´ë„ ë™ì¼í•œ ì•„ì›ƒí’‹ì…ë‹ˆë‹¤.   
  10ì´ˆë™ì•ˆ ìˆ˜ì§‘í• ë¿ì´ì§€ ìµœëŒ€ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” í•­ëª©ì€ 2ê°œì´ê¸° ë•Œë¬¸ì´ë‹ˆê¹Œìš”.   
  ê·¸ëŸ¼ ë§ˆì§€ë§‰ìœ¼ë¡œ timeSpanì„ ì ê²Œ countë¥¼ ë§ì´ í•´ë³´ê² ìŠµë‹ˆë‹¤.   
  ```swift
  import RxSwift
  
  Observable<Int>
  .interval(
      .seconds(1), 
      scheduler: MainScheduler.instance
  )
  .buffer(
      timeSpan: .seconds(3), 
      count: 5, 
      scheduler: MainScheduler.instance
  ) 
  .take(3) 
  .subscribe { 
      print($0) 
  } 
  .disposed(by: disposeBag)
  
  // OutPut
  [0, 1, 2]
  [3, 4, 5, 6]
  [7, 8, 9]
  ```
  ì ì˜ë³´ë©´ 3ì´ˆì˜ timeSpanì„ ì£¼ì—ˆìœ¼ë‹ˆ 3ì´ˆë™ì•ˆ ìˆ˜ì§‘í•©ë‹ˆë‹¤.   
  ìµœëŒ€ ìˆ˜ì§‘ í•­ëª©ì˜ ê°¯ìˆ˜ëŠ” 5ê°œêµ¬ìš”.   
  ê·¸ë˜ì„œ 1ì´ˆì˜ 1ê°œì”© ë°©ì¶œë˜ë‹ˆ 3ê°œì”© ë“¤ì–´ì˜¤ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   
  ê·¸ëŸ¬ë‚˜ ë‘ë²ˆì§¸ ì•„ì›ƒí’‹ì„ ë³´ë©´ 4ê°œì˜ í•­ëª©ì´ ìˆ˜ì§‘ë˜ì—ˆì£ ?   
  ê°„í˜¹ ì´ë ‡ê²Œ ì‹œê°„ ì˜¤ì°¨ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.   
  ê·¸ëŸ¬ë‚˜ ì–´ë– í•œ ì˜¤ì°¨ë”ë¼ë„ countë¡œ ì§€ì •í•œ ìµœëŒ€ê°’ì˜ ìˆ˜ì§‘ì„ ë„˜ì„ ìˆœ ì—†ìŠµë‹ˆë‹¤ğŸ˜ƒ   

  ì´ë ‡ê²Œ Bufferì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.   
  ê·¸ëŸ¬ë©´ ì´ì–´ì„œ WindowëŠ” Bufferì™€ ì–´ë–¤ ê³µí†µì ê³¼ ì°¨ì´ì ì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ì£ ğŸ™‹ğŸ»   

  #### Window   

  ##### Windowë€?   
  Bufferì™€ ë‹¬ë¦¬ ì˜µì €ë²„ë¸”ì˜ í•­ëª©ì„ ë¬¶ìŒì´ ì•„ë‹Œ í•˜ë‚˜ì”© ë°©ì¶œí•´ì¤ë‹ˆë‹¤.   
  ì¢€ ì‰½ê²Œ ì´í•´í•´ë³´ìë©´ ì–´ë– í•œ ê°€ë¦¼ë§‰ì´ ìˆë‹¤ê³  ìƒê°í•´ë³´ì£ .   
  ì´ ê°€ë¦¼ë§‰ì´ timeSpanë™ì•ˆì€ ë‹«í˜€ìˆì–´ìš”.   
  ê·¸ë¦¬ê³  timeSpanì´ ì§€ë‚˜ë©´ ê°€ë¦¼ë§‰ì´ ì—´ë¦½ë‹ˆë‹¤.   
  ê·¸ëŸ¬ë©´ ê°€ë¦¼ë§‰ì„ í†µê³¼í•˜ì§€ ëª»í•˜ê³  ìˆë˜ ì˜µì €ë²„ë¸”ë“¤ì´ ë°©ì¶œë˜ê²Œ ë©ë‹ˆë‹¤.   
  BufferëŠ” ì´ëŸ¬í•œ ê°€ë¦¼ë§‰ ëŒ€ì‹  ì–´ë– í•œ ë²ˆë“¤ì— ë¬¶ì–´ ê°™ì´ ë°©ì¶œí–ˆë‹¤ì¹˜ë©´   
  WindowëŠ” ë¬¶ì§€ ì•Šê³  ê°€ë¦¼ë§‰ ë’¤ì— ìˆë‹¤ ì§ í•˜ê³  ê°€ë¦¼ë§‰ì´ ì¹˜ì›Œì§€ë©´ ì§„í–‰ë˜ëŠ”ì ì…ë‹ˆë‹¤.   
  ì—¬ê¸°ì„œ 3ê°œì”© ê°€ë¦¼ë§‰ì´ ì¹˜ì›Œì§€ëŠ”ê²ƒì€ Bufferì™€ ë§ˆì°¬ê°€ì§€ë¡œ count íŒŒë¼ë¯¸í„° ì§€ì •ì…ë‹ˆë‹¤.   

  ##### Windowì˜ ì„ ì–¸   
  ```swift
  import RxSwift
  
  public func window(
      timeSpan: RxTimeInterval, 
      count: Int, 
      scheduler: SchedulerType
  ) -> Observable<Observable<Element>> {
      return WindowTimeCount(
          source: self.asObservable(), 
          timeSpan: timeSpan, 
          count: count, 
          scheduler: scheduler
      )
  }
  ```
  ì´ë ‡ê²Œ Bufferì™€ ì„ ì–¸ì´ ë¹„ìŠ·í• ìˆ˜ê°€ğŸ˜±   
  íŒŒë¼ë¯¸í„° ì‹œê·¸ë‹ˆì²˜ì— ëŒ€í•œ ì„¤ëª…ì€ Bufferì™€ ë™ì¼í•˜ê¸°ì— ë”°ë¡œ í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤.   
  ì—¬ê¸°ì„œ ì°¨ì´ëŠ” ë°˜í™˜íƒ€ì…ì…ë‹ˆë‹¤.   
  BufferëŠ” ì–´ë ˆì´ ì˜µì €ë²„ë¸”ì´ë©´ WindowëŠ” ì–´ë ˆì´ê°€ ì•„ë‹Œ í•˜ë‚˜í•˜ë‚˜ì”©ì¸ ì˜µì €ë²„ë¸” ìš”ì†Œë¥¼ ë°©ì¶œí•©ë‹ˆë‹¤.   
  ë!   

  ##### Windowì˜ ì‚¬ìš©   
  ```swift
  import RxSwift
  
  Observable<Int>
  .interval(
      .seconds(1), 
      scheduler: MainScheduler.instance
  )
  .window(
      timeSpan: .seconds(3), 
      count: 5, 
      scheduler: MainScheduler.instance
  ) 
  .take(3) 
  .subscribe { 
      if let observable = $0.element { 
          observable.subscribe { 
              print($0)
          } 
      } 
  } 
  .disposed(by: disposeBag)
  
  // Output
  [0, 1, 2]
  [3, 4, 5]
  [6, 7, 8, 9]
  ```
  ìš”ë ‡ê²Œ í•œë²ˆ ë³´ì‹œë©´, Bufferë•Œì˜ ì‚¬ìš© ì˜ˆì œì™€ ë™ì¼í•©ë‹ˆë‹¤.   
  ëŒ€ì‹  Observableì˜ elementë¡œ ì¶œë ¥í•´ì„œ í™•ì¸í•´ë´¤ìŠµë‹ˆë‹¤.   
  WindowëŠ” ìˆ˜ì§‘í•œ í•­ëª©ì„ ë°°ì—´ì´ ì•„ë‹Œ ê°ê°ì˜ ì˜µì €ë²„ë¸”ë¡œ ë¦¬í„´í•˜ê¸°ì— í•´ë‹¹ ì˜µì €ë²„ë¸”ì´ ì–´ë–¤ê±¸ ë°©ì¶œí•˜ê³  ì–´ëŠ ì‹œì ì— completedë˜ëŠ”ì§€ íŒŒì•…í•˜ëŠ”ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤.   

  ì´ë ‡ê²Œ Bufferì™€ Windowì— ëŒ€í•´ í•™ìŠµí•´ë³´ì•˜ìŠµë‹ˆë‹¤.   
  ì–´ëŠ ìƒí™©ì—ì„œ ì–´ë–¤ê±¸ ì ì¬ì ì†Œì— ì‚¬ìš©í• ì§€ ê°ì´ ë”± ì¡íˆì§„ ì•Šì•˜ì§€ë§Œ ì•ì„œ ë°°ìš´ Debounce / Throttle / Buffer / Window ëª¨ë‘ ì ì¬ì ì†Œì— ì‚¬ìš©ë˜ëŠ” ê·¸ë‚ ê¹Œì§€ğŸ¥³   

  ##### [ì°¸ê³ ìë£Œ]   
  https://green1229.tistory.com/180   
  http://reactivex.io/documentation/operators/buffer.html   
  http://reactivex.io/documentation/operators/window.html   
